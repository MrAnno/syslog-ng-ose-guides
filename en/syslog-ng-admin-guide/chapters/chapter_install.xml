<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter 
 [
 <!ENTITY % entities SYSTEM "../syslog-ng-entities.ent">
 %entities;]>
<chapter xml:id="chapter_install" xmlns="http://docbook.org/ns/docbook" version="5.0">
    <title>Installing syslog-ng</title>
    <indexterm>
        <primary>installing syslog-ng</primary>
    </indexterm>
    <para>This chapter explains how to install &product; on various platforms.</para>
    <itemizedlist>
        <listitem condition="ose">
            <para>You can install &abbrev; on many platforms using the package manager and official repositories of the platform. For a list of third-party packages available for various Linux, UNIX, and other platforms, see <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="http://www.balabit.com/network-security/syslog-ng/opensource-logging-system/downloads/3rd_party">third-party binaries page</link>.</para>
        </listitem>
        <listitem condition="ose">
            <para>For instructions on compiling syslog-ng Open Source Edition from the source code, see
                <xref linkend="compiling-syslog-ng"/>.</para>
        </listitem>
    </itemizedlist>
    <section xml:id="install_run" condition="pe">
        <title>Installing syslog-ng using the .run installer</title>
        <indexterm significance="preferred">
            <primary>installing syslog-ng</primary>
        </indexterm>
        <para>This section describes how to install the syslog-ng application interactively using
            the binary installer. The installer has a simple interface: use the TAB or the arrow
            keys of your keyboard to navigate between the options, and Enter to select an option.</para>
        <para>The syslog-ng binaries include all required libraries and dependencies of syslog-ng. The
            components are installed into the <filename>/opt/syslog-ng</filename> directory. It can
            automatically re-use existing configuration files, and also generate a simple
            configuration automatically into the <filename>/opt/syslog-ng/etc/syslog-ng.conf</filename>
            file. </para>
        <note>
            <para>There are two versions of every binary release. The one with the
                <parameter>client</parameter> suffix does not include the libraries required to log into
                SQL databases. If you are installing syslog-ng in client or relay mode, or you do not
                use the <parameter>sql()</parameter> destination, use these binaries. That way no
                unnecessary components are installed to your system. </para>
        </note>
        <indexterm>
            <primary>syslog-ng binaries</primary>
            <secondary>location of</secondary>
        </indexterm>
        <indexterm>
            <primary>installation path</primary>
        </indexterm>
        <para>The syslog-ng application can be installed interactively following the on-screen
            instructions as described in <xref linkend="install_run"/>, and also without user
            interaction using the silent installation option &mdash; see <xref
                linkend="install_run_silent"/>.</para>
        <itemizedlist>
            <listitem>
                <para>To install syslog-ng on clients or relays, complete <xref
                        linkend="install_run_client"/>.</para>
            </listitem>
            <listitem>
                <para>To install syslog-ng on your central logserver, complete <xref
                        linkend="install_run_server"/>.</para>
            </listitem>
            <listitem>
                <para>To install syslog-ng without any user-interaction, complete <xref
                        linkend="install_run_silent"/>.</para>
            </listitem>
        </itemizedlist>
        <note>
            <para>The installer stops the running syslogd application if it is running, but its
                components are not removed. The <filename>/etc/init.d/sysklogd</filename> init
                script is automatically renamed to <filename>/etc/init.d/sysklogd.backup</filename>.
                Rename this file to its original name if you want to remove syslog-ng or restart the syslogd package.</para>
        </note>

            <procedure xml:id="install_run_client">
                <title>Installing syslog-ng in client or relay mode</title>
                <indexterm>
                    <primary>installing syslog-ng</primary>
                    <secondary>on clients and relays</secondary>
                </indexterm>
                <formalpara>
                    <title>Purpose:</title>
                    <para/>
                </formalpara>
                <para>Complete the following steps to install &product; on clients or
                    relays. For details on the
                    different operation modes of syslog-ng, see <xref linkend="concepts_modes_of_operation"/>.</para>
                <formalpara>
                    <title>Steps:</title>
                    <para/>
                </formalpara>
                <step>
                <xi:include href="install_common.xml"
                    xpointer="xpointer(//step[@id = 'installer_welcome']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
                </step>
                <step>
                <xi:include href="install_common.xml"
                    xpointer="xpointer(//step[@id = 'installer_eula']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
                </step>
                <step>
                <xi:include href="install_common.xml"
                    xpointer="xpointer(//step[@id = 'installer_platform']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
                </step>
                <step>
                <xi:include href="install_common.xml"
                    xpointer="xpointer(//step[@id = 'installer_upgrade']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
                </step>
                <step>
                <xi:include href="install_common.xml"
                    xpointer="xpointer(//step[@id = 'installer_config']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
                </step>
                <step>
                <xi:include href="install_common.xml"
                    xpointer="xpointer(//step[@id = 'installer_path']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
                </step>
                <note>
                <xi:include href="install_common.xml" xpointer="xpointer(//note[@id = 'initscript_logrotate']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            </note>
            </procedure>

            <procedure xml:id="install_run_server">
                <title>Installing syslog-ng in server mode</title>
                <indexterm>
                    <primary>installing syslog-ng</primary>
                    <secondary>on logservers</secondary>
                </indexterm>
                <formalpara>
                    <title>Purpose:</title>
                    <para/>
                </formalpara>
                <para>Complete the following steps to install syslog-ng on logservers. For details on the different operation
                modes of syslog-ng, see <xref
                    linkend="concepts_modes_of_operation"/>.</para>
                <formalpara>
                    <title>Steps:</title>
                    <para/>
                </formalpara>
                <step>
                <xi:include href="install_common.xml"
                    xpointer="xpointer(//step[@id = 'installer_welcome']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
                </step>
                <step>
                <xi:include href="install_common.xml"
                    xpointer="xpointer(//step[@id = 'installer_eula']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
                </step>
                <step>
                <xi:include href="install_common.xml"
                    xpointer="xpointer(//step[@id = 'installer_platform']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
                </step>
                <step>
                <xi:include href="install_common.xml"
                    xpointer="xpointer(//step[@id = 'installer_upgrade']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
                </step>
                <step>
                <xi:include href="install_common.xml"
                    xpointer="xpointer(//step[@id = 'installer_config']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
                </step>
                <step>
                <xi:include href="install_common.xml"
                    xpointer="xpointer(//step[@id = 'installer_path']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
                </step>
            </procedure>
            <note>
                <xi:include href="install_common.xml" xpointer="xpointer(//note[@id = 'initscript_logrotate']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
            </note>
        <section xml:id="install_run_silent">
            <title>Installing syslog-ng without user-interaction</title>
            <indexterm>
                <primary>installing syslog-ng</primary>
                <secondary>in silent mode</secondary>
            </indexterm>
            <para>The syslog-ng application can be installed in silent mode without any
                user-interaction by specifying the required parameters from the command line.
                Answers to every question of the installer can be set in advance using command-line
                parameters.</para>
            <synopsis>./syslog-ng-&lt;version&gt;.run -- [options]</synopsis>
            <warning>
                <para>The <parameter>--</parameter> characters between the executable and the
                    parameters are mandatory, like in the following example:
                        <parameter>./syslog-ng-3.0.1b-solaris-10-sparc-client.run --
                        --accept-eula</parameter></para>
            </warning>
            <para>To display the list of parameters, execute the
                    <command>./syslog-ng-&lt;version&gt;.run --
                --h</command> command. Currently the following options are available:</para>
            <itemizedlist>
                <listitem>
                    <para><emphasis>--accept-eula or -a</emphasis>: Accept the EULA.</para>
                </listitem>
                <listitem>
                    <para><emphasis>--upgrade | -u</emphasis>: Perform automatic upgrade &mdash;
                        use the configuration file from an existing
                    installation.</para>
                </listitem>
                <listitem>
                    <para><emphasis>--remote &lt;destination host&gt;</emphasis>: Send logs
                        to the specified remote server. Not available when performing an
                    upgrade.</para>
                </listitem>
                <listitem>
                    <para><emphasis>--network</emphasis>: Accept messages from the network. Not
                        available when performing an upgrade.</para>
                </listitem>
                <listitem>
                    <para><emphasis>--configuration &lt;file&gt;</emphasis>: Use the
                        specified configuration file.</para>
                </listitem>
            </itemizedlist>
        </section>
    </section>

        <procedure xml:id="install_rpm" condition="pe">
            <title>Installing syslog-ng on RPM-based platforms (Red Hat, SUSE, AIX)</title>
            <indexterm>
            <primary>installing syslog-ng</primary>
            <secondary>from RPM package</secondary>
        </indexterm>
        <indexterm>
            <primary>installing syslog-ng</primary>
            <secondary>on Red Hat Enterprise Server</secondary>
        </indexterm>
        <indexterm>
            <primary>Red Hat Enterprise Server</primary>
            <secondary>installing syslog-ng</secondary>
        </indexterm>
        <indexterm>
            <primary>installing syslog-ng</primary>
            <secondary>on CentOS</secondary>
        </indexterm>
        <indexterm>
            <primary>CentOS</primary>
            <secondary>installing syslog-ng</secondary>
        </indexterm>
        <indexterm>
            <primary>installing syslog-ng</primary>
            <secondary>on AIX</secondary>
        </indexterm>
        <indexterm>
            <primary>AIX</primary>
            <secondary>installing syslog-ng</secondary>
        </indexterm>
        <indexterm>
            <primary>installing syslog-ng</primary>
            <secondary>on SUSE Linux Enterprise Server</secondary>
        </indexterm>
        <indexterm>
            <primary>SUSE Linux Enterprise Server</primary>
            <secondary>installing syslog-ng</secondary>
        </indexterm>
            <formalpara>
                <title>Purpose:</title>
                <para/>
            </formalpara>
            <para>To install syslog-ng on operating systems that use the Red Hat Package Manager (RPM),
                complete the following steps. Installing syslog-ng automatically replaces the original
                syslog service. The following supported operating systems use RPM: </para>
            <itemizedlist>
                <listitem>
                    <para>AIX 5.2 and 5.3</para>
                </listitem>
                <listitem>
                    <para>CentOS 4 and 5</para>
                </listitem>
                <listitem>
                    <para>openSUSE Linux Enterprise Server 10.0 and 10.1</para>
                </listitem>
                <listitem>
                    <para>Red Hat Enterprise Server 4 and 5</para>
                </listitem>
                <listitem>
                    <para>SUSE Linux Enterprise Server 10 and 10 SP1</para>
                </listitem>
            </itemizedlist>
            <formalpara>
                <title>Steps:</title>
                <para/>
            </formalpara>
            <step condition="ose">
                <para>Download the <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="http://www.balabit.com/network-security/syslog-ng/central-syslog-server/upgrades/"
                        >syslog-ng RPM package for your system</link>.</para>
            </step>
            <step condition="pe">
                <para>Login to <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="http://www.balabit.com/mybalabit"
                    >your MyBalabit account</link> and download the <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="http://www.balabit.com/network-security/syslog-ng/central-syslog-server/upgrades/"
                        >syslog-ng RPM package for your system</link>.</para>
            </step>
            <step>
                <itemizedlist>
                    <listitem>
                        <para>If the host already uses syslog-ng for logging, execute the following
                            command as root. Otherwise, skip this step. </para>
                        <synopsis>rpm -U syslog-ng-&lt;version&gt;-&lt;OS&gt;-&lt;arch&gt;.rpm</synopsis>
                        <para>The syslog-ng application and all its dependencies
                            will be installed, and the configuration of the existing syslog-ng
                            installation will be used.</para>
                        <note>
                            <para>If you are upgrading from syslog-ng version 2.1, note that the
                                location of the configuration file has been moved to
                                    <filename>/opt/syslog-ng/etc/syslog-ng.conf</filename></para>
                        </note>
                    </listitem>
                    <listitem>
                        <para>Execute the following command as root:</para>
                        <synopsis>rpm -i syslog-ng-&lt;version&gt;-&lt;OS&gt;-&lt;arch&gt;.rpm</synopsis>
                        <para>The syslog-ng application and all its dependencies
                            will be installed.</para>
                    </listitem>
                </itemizedlist>
            </step>
            <step>
                <warning>
                    <para>When performing an upgrade, the package manager might automatically
                        execute the post-uninstall script of the upgraded package, stopping
                        syslog-ng and starting syslogd. If this happens, stop syslogd and start
                        syslog-ng by issuing the following commands:</para>
                    <synopsis>/etc/init.d/syslogd stop
/etc/init.d/syslog-ng start</synopsis>
                    <para>This behavior has been detected on CentOS 4 systems, but may occur on
                        other rpm-based platforms as well.</para>
                </warning>
            </step>
            <!--<step>
                <indexterm>
                    <primary>Novell AppArmor</primary>
                </indexterm>
                <para><emphasis>Optional step</emphasis>: If Novell AppArmor is used on the
                    computer, copy the <filename>/usr/share/doc/syslog-ng/sbin.syslog-ng</filename>
                    file into the <filename>/etc/apparmor.d/</filename> directory and restart
                    AppArmor.</para>
            </step>-->
            <step>
                <para>
                    <indexterm>
                        <primary>AIX</primary>
                        <secondary>redirecting errorlog to syslog-ng</secondary>
                    </indexterm>
                    <emphasis>Optional step for AIX systems</emphasis>: To redirect the messages of
                    the AIX Error log into syslog, create a file (for example
                    <filename>/tmp/syslog-ng.add</filename>) with the following contents:</para>
                <synopsis>errnotify:
en_name = "syslog1"
en_persistenceflg = 1
en_method = "logger Msg from Error Log: `errpt -l $1 | grep -v 'ERROR_ID TIMESTAMP'`"</synopsis>
                <para>Then execute the following command as root: <command>odmadd
                    /tmp/syslog-ng.add</command>.</para>
            </step>
        </procedure>

        <procedure xml:id="install_deb" condition="pe">
            <title>Installing syslog-ng on Debian-based platforms</title>
            <indexterm>
            <primary>installing syslog-ng</primary>
            <secondary>from DEB package</secondary>
        </indexterm>
            <formalpara>
                <title>Purpose:</title>
                <para/>
            </formalpara>
            <para>To install syslog-ng on operating systems that use the Debian Software Package (deb)
            format, complete the following steps. The following supported operating systems use this
            format: </para>
        <itemizedlist>
            <listitem>
                <para>Debian etch</para>
            </listitem>
        </itemizedlist>
            <formalpara>
                <title>Steps:</title>
                <para/>
            </formalpara>
            <step condition="ose">
                <para>Download the <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href=""http://www.balabit.com/network-security/syslog-ng/central-syslog-server/upgrades/"
                        >syslog-ng DEB package for your system</link>.</para>
            </step>
            <step condition="pe">
                <para>Login to <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="http://www.balabit.com/mybalabit"
                    >your MyBalabit account</link> and download the <link xmlns:ns1="http://www.w3.org/1999/xlink" ns1:href="http://www.balabit.com/network-security/syslog-ng/central-syslog-server/upgrades/"
                        >syslog-ng DEB package for your system</link>.</para>
            </step>
            <!--<step>
                <para>Remove the existing system logging package from the host. Issue the following
                    command as root if the host is running syslog: <command>dpkg -r
                    sysklogd</command>, or <command>dpkg -r syslog-ng</command> if the host is
                    running the open source version of syslog-ng.</para>
            </step>-->
            <step>
                <para>Issue the following command as root: </para>
                <para>
                    <command>dpkg -i
                        syslog-ng-&lt;version&gt;-&lt;OS&gt;-&lt;arch&gt;.deb</command>
                </para>
            </step>
            <step>
                <para>Answer the configuration questions of syslog-ng. These are described in detail
                    in <xref linkend="install_run"/>.</para>
            </step>

            <!--<step>
                <indexterm>
                    <primary>Novell AppArmor</primary>
                </indexterm>
                <para><emphasis>Optional step</emphasis>: If Novell AppArmor is used on the
                    computer, copy the <filename>/usr/share/doc/syslog-ng/sbin.syslog-ng</filename>
                    file into the <filename>/etc/apparmor.d/</filename> directory and restart
                    AppArmor.</para>
            </step>-->
        </procedure>

    <xi:include href="compiling-syslog-ng.xml" xmlns:xi="http://www.w3.org/2001/XInclude"><xi:fallback>FIXME XINCLUDE ERROR</xi:fallback></xi:include>
    <xi:include href="uninstalling-syslog-ng.xml" xmlns:xi="http://www.w3.org/2001/XInclude"><xi:fallback>FIXME XINCLUDE ERROR</xi:fallback></xi:include>
    <xi:include href="configuring-mssql-server.xml" xmlns:xi="http://www.w3.org/2001/XInclude"><xi:fallback>FIXME XINCLUDE ERROR</xi:fallback></xi:include>
</chapter>
