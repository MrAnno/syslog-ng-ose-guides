<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE section SYSTEM "../../xml-stylesheet/pdf/dtd/docbookx.dtd"
 [  <!ENTITY % entities SYSTEM "../syslog-ng-entities.ent">
 %entities;]> 
<section id="configuring-destinations-smtp">
    <title>Generating SMTP messages (e-mail) from logs</title>
    <indexterm>
        <primary>destination drivers</primary>
        <secondary><parameter>smtp()</parameter> driver</secondary>
    </indexterm>
    <para>The <parameter>smtp()</parameter> sends e-mail messages using SMTP, without needing external applications.</para>
    <para>The destination filename may include macros which get expanded when the message is. For more information on available macros see <xref linkend="reference_macros"/>. </para>
    <para>The <parameter>file()</parameter> has a single required parameter that specifies the filename that stores the log messages. For the list of available optional parameters, see <xref linkend="reference-destination-smtp"/>.</para>
    <synopsis>Declaration:
        file(filename options());</synopsis>
            <example id="example-destination-smtp">
                <title>Using the file() driver</title>
                <synopsis>destination d_file { file("/var/log/messages" ); };</synopsis>
            </example>
<!--
            <example id="example_destination_file_macro">
                <title>Using the file() driver with macros in the file name and a template for the
                        message</title>
                <synopsis>destination d_file {
        file("/var/log/$YEAR.$MONTH.$DAY/messages"
             template("$HOUR:$MIN:$SEC $TZ $HOST [$LEVEL] $MSG $MSG\n")
             template_escape(no));
};</synopsis>
            </example>
-->
    <section id="reference-destination-smtp">
        <title>smtp() destination options</title>
        <indexterm>
            <primary>destination drivers</primary>
            <secondary><parameter>smtp()</parameter> driver</secondary>
        </indexterm>
        <para>The <parameter>smtp()</parameter> sends e-mail messages using SMTP, without needing external applications. The <parameter>smtp()</parameter> destination has the following options:</para>
        <simplesect id="smtp-option-body">
            <title>body()</title>
            <indexterm type="parameter">
                <primary>body()</primary>
                <secondary>smtp()</secondary>
            </indexterm>
            <indexterm type="parameter">
                <primary>smtp()</primary>
                <secondary>body()</secondary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>string</entry>
                        </row>
                        <row>
                            <entry>Default:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>n/a</entry>
                        </row>
                    </tbody>
                </tgroup>  
            </informaltable>
            <para><guilabel>Description:</guilabel> The BODY field of the e-mail. You can also use macros in the string. Use <parameter>\n</parameter> to start a new line. For example:</para>
            <synopsis>body("&abbrev; received the following alert from $HOST:\n$MSG")</synopsis>
        </simplesect>
        <simplesect id="smtp-option-bcc">
            <title>bcc()</title>
            <indexterm type="parameter">
                <primary>bcc()</primary>
                <secondary>smtp()</secondary>
            </indexterm>
            <indexterm type="parameter">
                <primary>smtp()</primary>
                <secondary>bcc()</secondary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>string</entry>
                        </row>
                        <row>
                            <entry>Default:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>n/a</entry>
                        </row>
                    </tbody>
                </tgroup>  
            </informaltable>
            <para><guilabel>Description:</guilabel> The BCC recipient of the e-mail (contents of the BCC field). You can specify the e-mail address, or the name and the e-mail address. Set the <parameter>bcc()</parameter> option multiple times to send the e-mail to multiple recipients. For example:
            <synopsis>bcc("admin@example.com")</synopsis> or
            <synopsis>bcc("Admin" "admin@example.com")</synopsis> or <synopsis>bcc("Admin" "admin@example.com")
bcc("Admin2" "admin2@example.com")</synopsis></para>
        </simplesect>
        <simplesect id="smtp-option-cc">
            <title>cc()</title>
            <indexterm type="parameter">
                <primary>cc()</primary>
                <secondary>smtp()</secondary>
            </indexterm>
            <indexterm type="parameter">
                <primary>smtp()</primary>
                <secondary>cc()</secondary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>string</entry>
                        </row>
                        <row>
                            <entry>Default:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>n/a</entry>
                        </row>
                    </tbody>
                </tgroup>  
            </informaltable>
            <para><guilabel>Description:</guilabel> The CC recipient of the e-mail (contents of the CC field). You can specify the e-mail address, or the name and the e-mail address. Set the <parameter>cc()</parameter> option multiple times to send the e-mail to multiple recipients. For example:
            <synopsis>cc("admin@example.com")</synopsis> or
            <synopsis>cc("Admin" "admin@example.com")</synopsis> or <synopsis>cc("Admin" "admin@example.com")
cc("Admin2" "admin2@example.com")</synopsis></para>
        </simplesect>
        <simplesect id="smtp-option-from">
            <title>from()</title>
            <indexterm type="parameter">
                <primary>from()</primary>
                <secondary>smtp()</secondary>
            </indexterm>
            <indexterm type="parameter">
                <primary>smtp()</primary>
                <secondary>from()</secondary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>string</entry>
                        </row>
                        <row>
                            <entry>Default:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>n/a</entry>
                        </row>
                    </tbody>
                </tgroup>  
            </informaltable>
            <para><guilabel>Description:</guilabel> The sender of the e-mail (contents of the FROM field). You can specify the e-mail address, or the name and the e-mail address. For example:
            <synopsis>from("admin@example.com")</synopsis> or
            <synopsis>from("Admin" "admin@example.com")</synopsis></para>
            <para>Instead of the <parameter>from()</parameter> option, you can also use <parameter>sender()</parameter>, which is just an alias of the <parameter>from()</parameter> option.</para>
        </simplesect>
        <simplesect id="smtp-option-header">
            <title>header()</title>
            <indexterm type="parameter">
                <primary>header()</primary>
                <secondary>smtp()</secondary>
            </indexterm>
            <indexterm type="parameter">
                <primary>smtp()</primary>
                <secondary>header()</secondary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>string</entry>
                        </row>
                        <row>
                            <entry>Default:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>n/a</entry>
                        </row>
                    </tbody>
                </tgroup>  
            </informaltable>
            <para><guilabel>Description:</guilabel> Adds an extra header to the e-mail with the specified name and content. The first parameter sets the name of the header, the second one its value. The value of the header can contain macros. Set the <parameter>header()</parameter> option multiple times to add multiple headers. For example:</para>
            <synopsis>header("X-Program", "$PROGRAM")</synopsis>
        </simplesect>
        <simplesect id="smtp-option-host">
            <title>host()</title>
            <indexterm type="parameter">
                <primary>host()</primary>
                <secondary>smtp()</secondary>
            </indexterm>
            <indexterm type="parameter">
                <primary>smtp()</primary>
                <secondary>host()</secondary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>hostname or IP address</entry>
                        </row>
                        <row>
                            <entry>Default:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>n/a</entry>
                        </row>
                    </tbody>
                </tgroup>  
            </informaltable>
            <para><guilabel>Description:</guilabel> Hostname or IP address of the SMTP server.</para>
            <note>
                <para>If you specify <parameter>host="localhost"</parameter>, &abbrev; will use a socket to connect to the local SMTP server. Use <parameter>host="127.0.0.1"</parameter> to force TCP communication between &abbrev; and the local SMTP server.</para>
            </note>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_commonoption_log_fifo_size']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect id="smtp-option-port">
            <title>port()</title>
            <indexterm type="parameter">
                <primary>port()</primary>
                <secondary>smtp()</secondary>
            </indexterm>
            <indexterm type="parameter">
                <primary>smtp()</primary>
                <secondary>port()</secondary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>number</entry>
                        </row>
                        <row>
                            <entry>Default:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>25</entry>
                        </row>
                    </tbody>
                </tgroup>  
            </informaltable>
            <para><guilabel>Description:</guilabel> The port number of the SMTP server.</para>
        </simplesect>
        <simplesect id="smtp-option-reply-to">
            <title>reply-to()</title>
            <indexterm type="parameter">
                <primary>reply-to()</primary>
                <secondary>smtp()</secondary>
            </indexterm>
            <indexterm type="parameter">
                <primary>smtp()</primary>
                <secondary>reply-to()</secondary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>string</entry>
                        </row>
                        <row>
                            <entry>Default:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>n/a</entry>
                        </row>
                    </tbody>
                </tgroup>  
            </informaltable>
            <para><guilabel>Description:</guilabel> Replies of the recipient will be sent to this address (contents of the REPLY-TO field). You can specify the e-mail address, or the name and the e-mail address. Set the <parameter>reply-to()</parameter> option multiple times to send the e-mail to multiple recipients. For example:
            <synopsis>reply-to("admin@example.com")</synopsis> or
            <synopsis>reply-to("Admin" "admin@example.com")</synopsis> or <synopsis>reply-to("Admin" "admin@example.com")
reply-to("Admin2" "admin2@example.com")</synopsis></para>
        </simplesect>
        <simplesect id="smtp-option-subject">
            <title>subject()</title>
            <indexterm type="parameter">
                <primary>subject()</primary>
                <secondary>smtp()</secondary>
            </indexterm>
            <indexterm type="parameter">
                <primary>smtp()</primary>
                <secondary>subject()</secondary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>string</entry>
                        </row>
                        <row>
                            <entry>Default:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>n/a</entry>
                        </row>
                    </tbody>
                </tgroup>  
            </informaltable>
            <para><guilabel>Description:</guilabel> The SUBJECT field of the e-mail. You can also use macros. For example:</para>
            <synopsis>subject("[SYSLOG ALERT]: Critical error message received from $HOST")</synopsis>
        </simplesect>
        <simplesect>
            <xi:include href="reference_common.xml" xpointer="xpointer(//simplesect[@id = 'destination_commonoption_throttle']/node() )" xmlns:xi="http://www.w3.org/2001/XInclude"/>
        </simplesect>
        <simplesect id="smtp-option-to">
            <title>to()</title>
            <indexterm type="parameter">
                <primary>to()</primary>
                <secondary>smtp()</secondary>
            </indexterm>
            <indexterm type="parameter">
                <primary>smtp()</primary>
                <secondary>to()</secondary>
            </indexterm>
            <informaltable frame="topbot" colsep="0" rowsep="0">
                <tgroup cols="2">
                <colspec colnum="1" colwidth="40pt"/>
                    <tbody>
                        <row>
                            <entry>Type:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>string</entry>
                        </row>
                        <row>
                            <entry>Default:
                                <?dbhtml bgcolor="#D4D6EB" ?><?dbfo bgcolor="#D4D6EB" ?></entry>
                            <entry>localhost</entry>
                        </row>
                    </tbody>
                </tgroup>  
            </informaltable>
            <para><guilabel>Description:</guilabel> The recipient of the e-mail (contents of the TO field). You can specify the e-mail address, or the name and the e-mail address. Set the <parameter>to()</parameter> option multiple times to send the e-mail to multiple recipients. For example:
            <synopsis>to("admin@example.com")</synopsis> or
            <synopsis>to("Admin" "admin@example.com")</synopsis> or <synopsis>to("Admin" "admin@example.com")
to("Admin2" "admin2@example.com")</synopsis></para>
        </simplesect>
    </section>
</section>
