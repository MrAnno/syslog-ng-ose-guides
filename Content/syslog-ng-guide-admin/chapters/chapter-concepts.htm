<?xml version="1.0" encoding="UTF-8"?>

  %entities;]&gt;
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><body name="chapter-concepts" oldrole="chapter">
<h1 name="chapter-concepts" oldrole="chapter">The concepts of syslog-ng</h1>
<p oldrole="para">This chapter discusses the technical concepts of syslog-ng.</p>

<h2 name="syslog-ng-philosophy">The philosophy of syslog-ng</h2>
<p name="para-philosophy-intro" oldrole="para">Typically, syslog-ng is used to manage log messages and implement centralized logging, where the aim is to collect the log messages of several devices on a single, central log server. The different devices <MadCap:variable name="General.mdash"></MadCap:variable> called syslog-ng clients <MadCap:variable name="General.mdash"></MadCap:variable> all run syslog-ng, and collect the log messages from the various applications, files, and other <i oldrole="emphasis">sources</i>. The clients send all important log messages to the remote syslog-ng server, which sorts and stores them.</p>


<h2 name="concepts-logging-with-syslog-ng">Logging with syslog-ng</h2>
<MadCap:keyword term="sources"></MadCap:keyword>
<MadCap:snippetBlock src="../../shared/chunk/intro-concepts.htm"></MadCap:snippetBlock>
<MadCap:snippetBlock src="concepts-route-of-a-message.htm"></MadCap:snippetBlock>


<h2 name="concepts-modes-of-operation">Modes of operation</h2>
<MadCap:keyword term="modes of operation"></MadCap:keyword>
<p name="para-modes-of-operation-intro" oldrole="para">The <MadCap:variable name="General.product"></MadCap:variable> application has three <MadCap:conditionaltext MadCap:conditions="pe">distinct </MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="ose">typical </MadCap:conditionaltext>operation scenarios: <i oldrole="emphasis">Client</i>, <i oldrole="emphasis">Server</i>, and <i oldrole="emphasis">Relay</i>.<MadCap:conditionaltext MadCap:conditions="pe"> The <MadCap:variable name="General.abbrev"></MadCap:variable> application running on a host determines the mode of operation automatically based on the license and the configuration file.</MadCap:conditionaltext></p>

<h2 name="concepts-client-mode">Client mode</h2>
<MadCap:keyword term="client mode"></MadCap:keyword>
<MadCap:keyword term="modes of operation:['client mode']"></MadCap:keyword>

<p class="CaptionFigure">Client-mode operation</p>

<img MadCap:mediastyle="@media print { width: auto; height: auto; }" class="Image" fileref="&lt;entity&gt;imgroot&lt;/entity&gt;/client_mode01.png" format="PNG" oldrole="figure" src="client_mode01.png" style="height: auto; width: auto;"/>
<p name="para-modes-of-operation-client" oldrole="para">In client mode, syslog-ng collects the local logs generated by the host and forwards them through a network connection to the central syslog-ng server or to a relay. Clients often also log the messages locally into files.</p>
<p condition="pe" oldrole="para">No license file is required to run syslog-ng in client mode.</p>


<h2 name="concepts-relay-mode">Relay mode</h2>
<MadCap:keyword term="relay mode"></MadCap:keyword>
<MadCap:keyword term="modes of operation:['relay mode']"></MadCap:keyword>

<p class="CaptionFigure">Relay-mode operation</p>

<img MadCap:mediastyle="@media print { width: auto; height: auto; }" class="Image" fileref="&lt;entity&gt;imgroot&lt;/entity&gt;/relay_mode01.png" format="PNG" oldrole="figure" scale="75" src="relay_mode01.png" style="height: auto; width: auto;"/>
<p name="para-modes-of-operation-relay" oldrole="para">In relay mode, syslog-ng receives logs through the network from syslog-ng clients and forwards them to the central syslog-ng server using a network connection. Relays also log the messages from the relay host into a local file, or forward these messages to the central syslog-ng server.</p>
<p condition="pe" oldrole="para">No license file is required to run syslog-ng in relay mode.</p>


<h2 name="concepts-server-mode">Server mode</h2>
<MadCap:keyword term="server mode"></MadCap:keyword>
<MadCap:keyword term="modes of operation:['server mode']"></MadCap:keyword>

<p class="CaptionFigure">Server-mode operation</p>

<img MadCap:mediastyle="@media print { width: auto; height: auto; }" class="Image" fileref="&lt;entity&gt;imgroot&lt;/entity&gt;/server_mode01.png" format="PNG" oldrole="figure" src="server_mode01.png" style="height: auto; width: auto;"/>
<p name="para-modes-of-operation-server" oldrole="para">In server mode, syslog-ng acts as a central log-collecting server. It receives messages from syslog-ng clients and relays over the network, and stores them locally in files, or passes them to other applications, for example log analyzers.</p>
<MadCap:keyword term="license"></MadCap:keyword>
<p condition="pe" oldrole="para">Running <MadCap:variable name="General.product"></MadCap:variable> in server mode requires a license file. The license determines how many individual hosts can connect to the server. For details on how <MadCap:variable name="General.abbrev"></MadCap:variable> calculates the number of hosts, see <MadCap:xref href="chapter-concepts.htm#concepts-licensing"></MadCap:xref>.</p>



<h2 name="msgroute">Global objects</h2>
<MadCap:keyword term="global objects"></MadCap:keyword>
<p oldrole="para">The syslog-ng application uses the following objects:</p>
<ul oldrole="itemizedlist">
<li oldrole="listitem">
<MadCap:keyword term="source drivers"></MadCap:keyword>
<p oldrole="para"><i oldrole="emphasis">Source driver</i>: A communication method used to receive log messages. For example, syslog-ng can receive messages from a remote host via TCP/IP, or read the messages of a local application from a file. For details on source drivers, see <MadCap:xref href="chapter-sources.htm#chapter-sources"></MadCap:xref>.</p>
</li>
<li oldrole="listitem">
<MadCap:keyword term="sources"></MadCap:keyword>
<p oldrole="para"><i oldrole="emphasis">Source</i>: A named collection of configured source drivers.</p>
</li>
<li oldrole="listitem">
<MadCap:keyword term="destination drivers"></MadCap:keyword>
<p oldrole="para"><i oldrole="emphasis">Destination driver</i>: A communication method used to send log messages. For example, syslog-ng can send messages to a remote host via TCP/IP, or write the messages into a file or database. For details on destination drivers, see <MadCap:xref href="chapter-destinations.htm#chapter-destinations"></MadCap:xref>.</p>
</li>
<li oldrole="listitem">
<MadCap:keyword term="destinations"></MadCap:keyword>
<p oldrole="para"><i oldrole="emphasis">Destination</i>: A named collection of configured destination drivers.</p>
</li>
<li oldrole="listitem">
<MadCap:keyword term="filters"></MadCap:keyword>
<p oldrole="para"><i oldrole="emphasis">Filter</i>: An expression to select messages. For example, a simple filter can select the messages received from a specific host. For details, see <MadCap:xref href="chapter-manipulating-messages.htm#customizing-message-format"></MadCap:xref>.</p>
</li>
<li oldrole="listitem">
<MadCap:keyword term="macros"></MadCap:keyword>
<p oldrole="para"><i oldrole="emphasis">Macro</i>: An identifier that refers to a part of the log message. For example, the <span class="Code" oldrole="parameter">${HOST}</span> macro returns the name of the host that sent the message. Macros are often used in templates and filenames. For details, see <MadCap:xref href="chapter-manipulating-messages.htm#customizing-message-format"></MadCap:xref>.</p>
</li>
<li oldrole="listitem">
<MadCap:keyword term="parsers"></MadCap:keyword>
<p oldrole="para"><i oldrole="emphasis">Parser</i>: Parsers are objects that parse the incoming messages, or parts of a message. For example, the <span class="Code" oldrole="parameter">csv-parser()</span> can segment messages into separate columns at a predefined separator character (for example a comma). Every column has a unique name that can be used as a macro. For details, see <MadCap:xref href="chapter-parsers.htm#chapter-parsers"></MadCap:xref> and <MadCap:xref href="chapter-patterndb.htm#chapter-patterndb"></MadCap:xref>.</p>
</li>
<li oldrole="listitem">
<MadCap:keyword term="rewrite rules"></MadCap:keyword>
<p oldrole="para"><i oldrole="emphasis">Rewrite rule</i>: A rule modifies a part of the message, for example, replaces a string, or sets a field to a specified value. For details, see <MadCap:xref href="chapter-manipulating-messages.htm#modifying-messages"></MadCap:xref>.</p>
</li>
<li oldrole="listitem">
<MadCap:keyword term="log statements"></MadCap:keyword>
<p oldrole="para"><i oldrole="emphasis">Log paths</i>: A combination of sources, destinations, and other objects like filters, parsers, and rewrite rules. The syslog-ng application sends messages arriving from the sources of the log paths to the defined destinations, and performs filtering, parsing, and rewriting of the messages. Log paths are also called log statements. Log statements can include other (embedded) log statements and junctions to create complex log paths. For details, see <MadCap:xref href="chapter-routing-filters.htm#chapter-routing-filters"></MadCap:xref>.</p>
</li>
<li oldrole="listitem">
<MadCap:keyword term="templates"></MadCap:keyword>
<p oldrole="para"><i oldrole="emphasis">Template</i>: A template is a set of macros that can be used to restructure log messages or automatically generate file names. For example, a template can add the hostname and the date to the beginning of every log message. For details, see <MadCap:xref href="chapter-manipulating-messages.htm#customizing-message-format"></MadCap:xref>.</p>
</li>
<li oldrole="listitem">
<MadCap:keyword term="options"></MadCap:keyword>
<p oldrole="para"><i oldrole="emphasis">Option</i>: Options set global parameters of syslog-ng, like the parameters of name resolution and timezone handling. For details, see <MadCap:xref href="chapter-global-options.htm#chapter-global-options"></MadCap:xref>.</p>
</li>
</ul>
<p oldrole="para">For details on the above objects, see <MadCap:xref href="chapter-configuration-file.htm#configuration-syntax"></MadCap:xref>.</p>


<h2 name="timezone-handling">Timezones and daylight saving</h2>
<MadCap:keyword term="daylight saving changes"></MadCap:keyword>
<p oldrole="para">The syslog-ng application receives the timezone and daylight saving information from the operating system it is installed on. If the operating system handles daylight saving correctly, so does syslog-ng.</p>
<MadCap:keyword term="timezones"></MadCap:keyword>
<p oldrole="para">The syslog-ng application supports messages originating from different timezones. The original syslog protocol (RFC3164) does not include timezone information, but syslog-ng provides a solution by extending the syslog protocol to include the timezone in the log messages. The syslog-ng application also enables administrators to supply timezone information for legacy devices which do not support the protocol extension.</p>
<MadCap:snippetBlock src="procedure-associating-timezone.htm"></MadCap:snippetBlock>

<h2 name="example-timezones">A note on timezones and timestamps</h2>
<MadCap:keyword term="timestamp"></MadCap:keyword>
<MadCap:keyword term="timezones"></MadCap:keyword>
<MadCap:keyword term="UTC"></MadCap:keyword>
<MadCap:keyword term="Coordinated Universal Time"></MadCap:keyword>
<p oldrole="para">If the clients run syslog-ng, then use the ISO timestamp, because it includes timezone information. That way you do not need to adjust the <span class="Code" oldrole="parameter">recv-time-zone()</span> parameter of syslog-ng.</p>
<p oldrole="para">If you want syslog-ng to output timestamps in Unix (POSIX) time format, use the <span class="Code" oldrole="parameter">S_UNIXTIME</span> and <span class="Code" oldrole="parameter">R_UNIXTIME</span> macros. You do not need to change any of the timezone related parameters, because the timestamp information of incoming messages is converted to Unix time internally, and Unix time is a timezone-independent time representation. (Actually, Unix time measures the number of seconds elapsed since midnight of Coordinated Universal Time (UTC) January 1, 1970, but does not count leap seconds.)</p>



<h2 name="concepts-licensing">The license of <MadCap:variable name="General.abbrev"></MadCap:variable></h2>
<p oldrole="para">Starting with version 3.2, the <MadCap:variable name="General.product"></MadCap:variable> application is licensed under a combined LGPL+GPL license. The core of <MadCap:variable name="General.abbrev"></MadCap:variable> is licensed under the GNU Lesser General Public License Version 2.1 license, while the rest of the codebase is licensed under the GNU General Public License Version 2 license.</p>
<table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="note" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');"><col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;"></col><col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2"></col><tbody><tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1"><td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1"><p><img src="../../Resources/Images/Common/note.png"/></p></td><td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">NOTE: </span><p oldrole="para">Practically, the code stored under the <span class="Code" oldrole="filename">lib</span> directory of the source code package is under LGPL, the rest is GPL.</p></td></tr></tbody></table>
<p oldrole="para">For details about the LGPL and GPL licenses, see <MadCap:xref href="#lgpl"></MadCap:xref> and <MadCap:xref href="../../shared/app-gpl.htm#gpl"></MadCap:xref>, respectively.</p>


<h2 name="concepts-high-availability">High availability support</h2>
<MadCap:keyword term="fail-over"></MadCap:keyword>
<p oldrole="para">Multiple syslog-ng servers can be run in fail-over mode. The syslog-ng application does not include any internal support for this, as clustering support must be implemented on the operating system level. A tool that can be used to create UNIX clusters is Heartbeat (for details, see <a href="http://www.linux-ha.org/wiki/Main_Page/">this page</a>).</p>
<p condition="pe" oldrole="para">Starting with <entity>product</entity> version 3.2, <entity>abbrev</entity> clients can be configured to send the log messages to failover servers in case the primary syslog server becomes unaccessible. For details on configuring failover servers, see the description of the <span class="Code" oldrole="parameter">failover-servers()</span> destination option in <xref linkend="chapter-destinations"></xref>.</p>


<h2 name="concepts-message-structure">The structure of a log message</h2>
<indexterm>
<primary>log messages, structure</primary>
</indexterm>
<p oldrole="para">The following sections describe the structure of log messages. Currently there are two standard syslog message formats:</p>
<ul oldrole="itemizedlist">
<li oldrole="listitem">
<p oldrole="para">The old standard described in RFC 3164 (also called the BSD-syslog or the legacy-syslog protocol): see <xref linkend="concepts-message-bsdsyslog"></xref></p>
</li>
<li oldrole="listitem">
<p oldrole="para">The new standard described in RFC 5424 (also called the IETF-syslog protocol): see <xref linkend="concepts-message-ietfsyslog"></xref></p>
</li>
<li oldrole="listitem">
<p oldrole="para">How messages are represented in <entity>abbrev</entity>: see <xref linkend="concepts-message-representation"></xref>.</p>
</li>
</ul>

<h2 name="concepts-message-bsdsyslog">BSD-syslog or legacy-syslog messages</h2>
<indexterm>
<primary>log messages, structure</primary>
<secondary>BSD-syslog protocol</secondary>
</indexterm>
<indexterm>
<primary>log messages, structure</primary>
<secondary>legacy-syslog protocol</secondary>
</indexterm>
<indexterm>
<primary>log messages, structure</primary>
<secondary>RFC 3164</secondary>
</indexterm>
<p oldrole="para">This section describes the format of a syslog message, according to the <a href="https://tools.ietf.org/search/rfc3164">legacy-syslog or BSD-syslog protocol</a>. A syslog message consists of the following parts:</p>
<ul oldrole="itemizedlist">
<li oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter"> <a href="chapter-concepts.htm">PRI</a> </span></p>
</li>
<li oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter"> <a href="chapter-concepts.htm">HEADER</a> </span></p>
</li>
<li oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter"> <a href="chapter-concepts.htm">MSG</a> </span></p>
</li>
</ul>
<p oldrole="para">The total message cannot be longer than 1024 bytes.</p>
<p oldrole="para">The following is a sample syslog message: <i oldrole="emphasis">&lt;133&gt;Feb 25 14:09:07 webserver syslogd: restart</i>. The message corresponds to the following format: <i oldrole="emphasis">&lt;priority&gt;timestamp hostname application: message</i>. The different parts of the message are explained in the following sections.</p>
<table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="note" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');"><col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;"></col><col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2"></col><tbody><tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1"><td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1"><p><img src="../../Resources/Images/Common/note.png"/></p></td><td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">NOTE: </span><p oldrole="para">The syslog-ng application supports longer messages as well. For details, see the <span class="Code" oldrole="parameter">log-msg-size()</span> option in <xref linkend="reference-options"></xref>. However, it is not recommended to enable messages larger than the packet size when using UDP destinations.</p></td></tr></tbody></table>

<h2 name="bsdsyslog-pri">The PRI message part</h2>
<p oldrole="para">The PRI part of the syslog message (known as Priority value) represents the Facility and Severity of the message. Facility represents the part of the system sending the message, while severity marks its importance. The Priority value is calculated by first multiplying the Facility number by 8 and then adding the numerical value of the Severity. The possible facility and severity values are presented below.</p>
<table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="note" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');"><col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;"></col><col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2"></col><tbody><tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1"><td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1"><p><img src="../../Resources/Images/Common/note.png"/></p></td><td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">NOTE: </span><p oldrole="para">Facility codes may slightly vary between different platforms. The syslog-ng application accepts facility codes as numerical values as well.</p></td></tr></tbody></table>
<table>
<title>syslog Message Facilities</title>
<?dbfo keep-together="auto" ?>
<indexterm>
<primary>facilities</primary>
</indexterm>
<indexterm>
<primary>message</primary>
<secondary>facilities</secondary>
</indexterm>
<tgroup cols="2">
<thead>
<row>
<entry>Numerical Code</entry>
<entry>Facility</entry>
</row>
</thead>
<tbody>
<row>
<entry>0</entry>
<entry>kernel messages</entry>
</row>
<row>
<entry>1</entry>
<entry>user-level messages</entry>
</row>
<row>
<entry>2</entry>
<entry>mail system</entry>
</row>
<row>
<entry>3</entry>
<entry>system daemons</entry>
</row>
<row>
<entry>4</entry>
<entry>security/authorization messages</entry>
</row>
<row>
<entry>5</entry>
<entry>messages generated internally by syslogd</entry>
</row>
<row>
<entry>6</entry>
<entry>line printer subsystem</entry>
</row>
<row>
<entry>7</entry>
<entry>network news subsystem</entry>
</row>
<row>
<entry>8</entry>
<entry>UUCP subsystem</entry>
</row>
<row>
<entry>9</entry>
<entry>clock daemon</entry>
</row>
<row>
<entry>10</entry>
<entry>security/authorization messages</entry>
</row>
<row>
<entry>11</entry>
<entry>FTP daemon</entry>
</row>
<row>
<entry>12</entry>
<entry>NTP subsystem</entry>
</row>
<row>
<entry>13</entry>
<entry>log audit</entry>
</row>
<row>
<entry>14</entry>
<entry>log alert</entry>
</row>
<row>
<entry>15</entry>
<entry>clock daemon</entry>
</row>
<row>
<entry>16-23</entry>
<entry>locally used facilities (local0-local7)</entry>
</row>
</tbody>
</tgroup>
</table>
<p oldrole="para">The following table lists the severity values.</p>
<table>
<title>syslog Message Severities</title>
<tgroup cols="2">
<thead>
<row>
<entry>Numerical Code</entry>
<entry>Severity</entry>
</row>
</thead>
<tbody>
<row>
<entry>0</entry>
<entry>Emergency: system is unusable</entry>
</row>
<row>
<entry>1</entry>
<entry>Alert: action must be taken immediately</entry>
</row>
<row>
<entry>2</entry>
<entry>Critical: critical conditions</entry>
</row>
<row>
<entry>3</entry>
<entry>Error: error conditions</entry>
</row>
<row>
<entry>4</entry>
<entry>Warning: warning conditions</entry>
</row>
<row>
<entry>5</entry>
<entry>Notice: normal but significant condition</entry>
</row>
<row>
<entry>6</entry>
<entry>Informational: informational messages</entry>
</row>
<row>
<entry>7</entry>
<entry>Debug: debug-level messages</entry>
</row>
</tbody>
</tgroup>
</table>


<h2 name="bsdsyslog-header">The HEADER message part</h2>
<indexterm>
<primary>timestamp</primary>
</indexterm>
<indexterm>
<primary>local time</primary>
</indexterm>
<p oldrole="para">The HEADER part contains a timestamp and the hostname (without the domain name) or the IP address of the device. The timestamp field is the local time in the <i oldrole="emphasis">Mmm dd hh:mm:ss</i> format, where:</p>
<ul oldrole="itemizedlist">
<li oldrole="listitem">
<p oldrole="para"><i oldrole="emphasis">Mmm</i> is the English abbreviation of the month: Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec.</p>
</li>
<li oldrole="listitem">
<p oldrole="para"><i oldrole="emphasis">dd</i> is the day of the month on two digits. If the day of the month is less than 10, the first digit is replaced with a space. (For example <i oldrole="emphasis">Aug 7</i>.)</p>
</li>
<li oldrole="listitem">
<p oldrole="para"><i oldrole="emphasis">hh:mm:ss</i> is the local time. The hour (hh) is represented in a 24-hour format. Valid entries are between 00 and 23, inclusive. The minute (mm) and second (ss) entries are between 00 and 59 inclusive.</p>
</li>
</ul>
<table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="note" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');"><col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;"></col><col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2"></col><tbody><tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1"><td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1"><p><img src="../../Resources/Images/Common/note.png"/></p></td><td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">NOTE: </span><p oldrole="para">The syslog-ng application supports other timestamp formats as well, like ISO, or the PIX extended format. For details, see the <span class="Code" oldrole="parameter">ts-format()</span> option in <xref linkend="reference-options"></xref>.</p></td></tr></tbody></table>


<h2 name="bsdsyslog-msg">The MSG message part</h2>
<p oldrole="para">The MSG part contains the name of the program or process that generated the message, and the text of the message itself. The MSG part is usually in the following format: <i oldrole="emphasis">program[pid]: message text</i>.</p>



<h2 name="concepts-message-ietfsyslog">IETF-syslog messages</h2>
<indexterm>
<primary>log messages, structure</primary>
<secondary>IETF-syslog protocol</secondary>
</indexterm>
<indexterm>
<primary>log messages, structure</primary>
<secondary>RFC 5424</secondary>
</indexterm>
<p oldrole="para">This section describes the format of a syslog message, according to the <a href="https://tools.ietf.org/html/rfc5424">IETF-syslog protocol</a>. A syslog message consists of the following parts:</p>
<ul oldrole="itemizedlist">
<li oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter"> <a href="chapter-concepts.htm">HEADER</a></span> (includes the <span class="Code" oldrole="parameter"><a href="chapter-concepts.htm">PRI</a></span> as well)</p>
</li>
<li oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter"> <a href="chapter-concepts.htm">STRUCTURED-DATA</a> </span></p>
</li>
<li oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter"> <a href="chapter-concepts.htm">MSG</a> </span></p>
</li>
</ul>
<!--FIXME update
                <para>The total message must be shorter than 1024 bytes.</para>
            <note>
                <para>The syslog-ng application supports longer messages as well. For details, see
                    the <parameter>log-msg-size()</parameter> option in <xref
                        linkend="reference-options"/>. However, it is not recommended to enable
                    messages larger than the packet size when using UDP destinations.</para>
            </note>
            -->
<p oldrole="para">The following is a sample syslog message:<footnote>
<p oldrole="para">Source: https://tools.ietf.org/html/rfc5424</p>
</footnote></p>
<pre class="Code" oldrole="synopsis">&lt;34&gt;1 2003-10-11T22:14:15.003Z mymachine.example.com su - ID47 - BOM'su root' failed for lonvick on /dev/pts/8</pre>
<p oldrole="para">The message corresponds to the following format:</p>
<pre class="Code" oldrole="synopsis">&lt;priority&gt;VERSION ISOTIMESTAMP HOSTNAME APPLICATION PID MESSAGEID STRUCTURED-DATA MSG</pre>
<p oldrole="para">In this example, the Facility has the value of 4, severity is 2, so PRI is 34. The VERSION is 1. The message was created on 11 October 2003 at 10:14:15pm UTC, 3 milliseconds into the next second. The message originated from a host that identifies itself as "mymachine.example.com". The APP-NAME is "su" and the PROCID is unknown. The MSGID is "ID47". The MSG is "'su root' failed for lonvick...", encoded in UTF-8. The encoding is defined by the<glossterm linkend="glossary-bom" role="underline">BOM</glossterm><footnote>
<MadCap:snippetBlock src="../../shared/chunk/para-bom-definition.htm"></MadCap:snippetBlock>
</footnote>. There is no STRUCTURED-DATA present in the message, this is indicated by "-" in the STRUCTURED-DATA field. The MSG is "'su root' failed for lonvick...".</p>
<p oldrole="para">The HEADER part of the message must be in plain ASCII format, the parameter values of the STRUCTURED-DATA part must be in UTF-8, while the MSG part should be in UTF-8. The different parts of the message are explained in the following sections.</p>

<h2 name="ietfsyslog-pri">The PRI message part</h2>
<p oldrole="para">The PRI part of the syslog message (known as Priority value) represents the Facility and Severity of the message. Facility represents the part of the system sending the message, while severity marks its importance. The Priority value is calculated by first multiplying the Facility number by 8 and then adding the numerical value of the Severity. The possible facility and severity values are presented below.</p>
<table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="note" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');"><col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;"></col><col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2"></col><tbody><tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1"><td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1"><p><img src="../../Resources/Images/Common/note.png"/></p></td><td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">NOTE: </span><p oldrole="para">Facility codes may slightly vary between different platforms. The syslog-ng application accepts facility codes as numerical values as well.</p></td></tr></tbody></table>
<table>
<title>syslog Message Facilities</title>
<?dbfo keep-together="auto" ?>
<indexterm>
<primary>facilities</primary>
</indexterm>
<indexterm>
<primary>message</primary>
<secondary>facilities</secondary>
</indexterm>
<tgroup cols="2">
<thead>
<row>
<entry>Numerical Code</entry>
<entry>Facility</entry>
</row>
</thead>
<tbody>
<row>
<entry>0</entry>
<entry>kernel messages</entry>
</row>
<row>
<entry>1</entry>
<entry>user-level messages</entry>
</row>
<row>
<entry>2</entry>
<entry>mail system</entry>
</row>
<row>
<entry>3</entry>
<entry>system daemons</entry>
</row>
<row>
<entry>4</entry>
<entry>security/authorization messages</entry>
</row>
<row>
<entry>5</entry>
<entry>messages generated internally by syslogd</entry>
</row>
<row>
<entry>6</entry>
<entry>line printer subsystem</entry>
</row>
<row>
<entry>7</entry>
<entry>network news subsystem</entry>
</row>
<row>
<entry>8</entry>
<entry>UUCP subsystem</entry>
</row>
<row>
<entry>9</entry>
<entry>clock daemon</entry>
</row>
<row>
<entry>10</entry>
<entry>security/authorization messages</entry>
</row>
<row>
<entry>11</entry>
<entry>FTP daemon</entry>
</row>
<row>
<entry>12</entry>
<entry>NTP subsystem</entry>
</row>
<row>
<entry>13</entry>
<entry>log audit</entry>
</row>
<row>
<entry>14</entry>
<entry>log alert</entry>
</row>
<row>
<entry>15</entry>
<entry>clock daemon</entry>
</row>
<row>
<entry>16-23</entry>
<entry>locally used facilities (local0-local7)</entry>
</row>
</tbody>
</tgroup>
</table>
<p oldrole="para">The following table lists the severity values.</p>
<table>
<title>syslog Message Severities</title>
<tgroup cols="2">
<thead>
<row>
<entry>Numerical Code</entry>
<entry>Severity</entry>
</row>
</thead>
<tbody>
<row>
<entry>0</entry>
<entry>Emergency: system is unusable</entry>
</row>
<row>
<entry>1</entry>
<entry>Alert: action must be taken immediately</entry>
</row>
<row>
<entry>2</entry>
<entry>Critical: critical conditions</entry>
</row>
<row>
<entry>3</entry>
<entry>Error: error conditions</entry>
</row>
<row>
<entry>4</entry>
<entry>Warning: warning conditions</entry>
</row>
<row>
<entry>5</entry>
<entry>Notice: normal but significant condition</entry>
</row>
<row>
<entry>6</entry>
<entry>Informational: informational messages</entry>
</row>
<row>
<entry>7</entry>
<entry>Debug: debug-level messages</entry>
</row>
</tbody>
</tgroup>
</table>


<h2 name="ietfsyslog-header">The HEADER message part</h2>
<indexterm>
<primary>timestamp</primary>
</indexterm>
<indexterm>
<primary>local time</primary>
</indexterm>
<p oldrole="para">The HEADER part contains the following elements:</p>
<ul oldrole="itemizedlist">
<li oldrole="listitem">
<p oldrole="para"><i oldrole="emphasis">VERSION</i>: Version number of the syslog protocol standard. Currently this can only be <span class="Code" oldrole="userinput">1</span>.</p>
</li>
<li oldrole="listitem">
<p oldrole="para"><i oldrole="emphasis">ISOTIMESTAMP</i>: The time when the message was generated in the ISO 8601 compatible standard timestamp format (yyyy-mm-ddThh:mm:ss+-ZONE), for example: <span class="Code" oldrole="userinput">2006-06-13T15:58:00.123+01:00</span>.</p>
</li>
<li oldrole="listitem">
<p oldrole="para"><i oldrole="emphasis">HOSTNAME</i>: The machine that originally sent the message.</p>
</li>
<li oldrole="listitem">
<p oldrole="para"><i oldrole="emphasis">APPLICATION</i>: The device or application that generated the message</p>
</li>
<li oldrole="listitem">
<p oldrole="para"><i oldrole="emphasis">PID</i>: The process name or process ID of the syslog application that sent the message. It is not necessarily the process ID of the application that generated the message.</p>
</li>
<li oldrole="listitem">
<p oldrole="para"><i oldrole="emphasis">MESSAGEID</i>: The ID number of the message.</p>
</li>
</ul>
<table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="note" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');"><col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;"></col><col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2"></col><tbody><tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1"><td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1"><p><img src="../../Resources/Images/Common/note.png"/></p></td><td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">NOTE: </span><p oldrole="para">The syslog-ng application supports other timestamp formats as well, like ISO, or the PIX extended format. The timestamp used in the IETF-syslog protocol is derived from RFC3339, which is based on ISO8601. For details, see the <span class="Code" oldrole="parameter">ts-format()</span> option in <xref linkend="reference-options"></xref>.</p></td></tr></tbody></table>
<p oldrole="para">The <entity>abbrev</entity> application will truncate the following fields:</p>
<ul oldrole="itemizedlist">
<li oldrole="listitem">
<p oldrole="para">If <i oldrole="emphasis">APP-NAME</i> is longer than 48 characters it will be truncated to 48 characters.</p>
</li>
<li oldrole="listitem">
<p oldrole="para">If <i oldrole="emphasis">PROC-ID</i> is longer than 128 characters it will be truncated to 128 characters.</p>
</li>
<li oldrole="listitem">
<p oldrole="para">If <i oldrole="emphasis">MSGID</i> is longer than 32 characters it will be truncated to 32 characters.</p>
</li>
<li oldrole="listitem">
<p oldrole="para">If <i oldrole="emphasis">HOSTNAME</i> is longer than 255 characters it will be truncated to 255 characters.</p>
</li>
</ul>


<h2 name="ietfsyslog-structureddata">The STRUCTURED-DATA message part</h2>
<p oldrole="para">The STRUCTURED-DATA message part may contain meta- information about the syslog message, or application-specific information such as traffic counters or IP addresses. STRUCTURED-DATA consists of data blocks enclosed in brackets (<i oldrole="emphasis">[]</i>). Every block includes the ID of the block, and one or more <i oldrole="emphasis">name=value</i> pairs. The syslog-ng application automatically parses the STRUCTURED-DATA part of syslog messages, which can be referenced in macros (for details, see <xref linkend="reference-macros"></xref>). An example STRUCTURED-DATA block looks like:</p>
<pre class="Code" oldrole="synopsis">[exampleSDID@0 iut="3" eventSource="Application" eventID="1011"][examplePriority@0 class="high"]</pre>


<h2 name="ietfsyslog-msg">The MSG message part</h2>
<p oldrole="para">The MSG part contains the text of the message itself. The encoding of the text must be UTF-8 if the<glossterm linkend="glossary-bom" role="underline">BOM</glossterm><footnote>
<MadCap:snippetBlock src="../../shared/chunk/para-bom-definition.htm"></MadCap:snippetBlock>
</footnote>character is present in the message. If the message does not contain the BOM character, the encoding is treated as unknown. Usually messages arriving from legacy sources do not include the BOM character. CRLF characters will not be removed from the message.</p>




<h2 name="concepts-message-representation">Message representation in <entity>abbrev</entity></h2>
<indexterm>
<primary>log messages, representation</primary>
</indexterm>
<p oldrole="para">When the <entity>abbrev</entity> application receives a message, it automatically parses the message. The <entity>abbrev</entity> application can automatically parse log messages that conform to the RFC3164 (BSD or legacy-syslog) or the RFC5424 (IETF-syslog) message formats. If <entity>abbrev</entity> cannot parse a message, it results in an error.</p>
<table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="tip" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');"><col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;"></col><col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2"></col><tbody><tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1"><td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1"><p><img src="../../Resources/Images/Common/note.png"/></p></td><td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">TIP: </span><p oldrole="para">In case you need to relay messages that cannot be parsed without any modifications or changes, use the <span class="Code" oldrole="parameter">flags(no-parse)</span> option in the source definition, and a template containing only the <span class="Code" oldrole="parameter">${MESSAGE}</span> macro in the destination definition.</p><p oldrole="para">To parse non-syslog messages, for example, JSON, CSV, or other messages, you can use the built-in parsers of <entity>abbrev</entity>. For details, see <xref linkend="chapter-parsers"></xref>.</p></td></tr></tbody></table>
<p oldrole="para">A parsed syslog message has the following parts.</p>
<ul oldrole="itemizedlist">
<li oldrole="listitem">

<p><b oldrole="formalpara">Timestamps</b></p>
<p oldrole="para">Two timestamps are associated with every message: one is the timestamp contained within the message (that is, when the sender sent the message), the other is the time when <entity>abbrev</entity> has actually received the message.</p>

</li>
<li oldrole="listitem">

<p><b oldrole="formalpara">Severity</b></p>
<p oldrole="para">The severity of the message.</p>

</li>
<li oldrole="listitem">

<p><b oldrole="formalpara">Facility</b></p>
<p oldrole="para">The facility that sent the message.</p>

</li>
<li oldrole="listitem">

<p><b oldrole="formalpara">Tags</b></p>
<p oldrole="para">Custom text labels added to the message that are mainly used for filtering. None of the current message transport protocols adds tags to the log messages. Tags can be added to the log message only within <entity>abbrev</entity>. The <entity>abbrev</entity> application automatically adds the id of the source as a tag to the incoming messages. Other tags can be added to the message by the pattern database, or using the <span class="Code" oldrole="parameter">tags()</span> option of the source.</p>

</li>
<li oldrole="listitem">

<p><b oldrole="formalpara">IP address of the sender</b></p>
<p oldrole="para">The IP address of the host that sent the message. Note that the IP address of the sender is a hard macro and cannot be modified within <entity>abbrev</entity> but the associated hostname can be modified, for example, using rewrite rules.</p>
<!-- FIXME is this the original sender, or the last relay? -->

</li>
<li oldrole="listitem">

<p><b oldrole="formalpara">Hard macros</b></p>
<indexterm>
<primary>macros</primary>
<secondary>hard</secondary>
</indexterm>
<indexterm>
<primary>macros</primary>
<secondary>read-only</secondary>
</indexterm>
<indexterm>
<primary>hard macros</primary>
</indexterm>
<indexterm>
<primary>read-only macros</primary>
</indexterm>
<p oldrole="para">Hard macros contain data that is directly derived from the log message, for example, the ${MONTH} macro derives its value from the timestamp. The most important consideration with hard macros is that they are read-only, meaning they cannot be modified using rewrite rules or other means.</p>

</li>
<li oldrole="listitem">

<p><b oldrole="formalpara">Soft macros</b></p>
<indexterm>
<primary>macros</primary>
<secondary>soft</secondary>
</indexterm>
<indexterm>
<primary>macros</primary>
<secondary>rewritable</secondary>
</indexterm>
<indexterm>
<primary>soft macros</primary>
</indexterm>
<indexterm>
<primary>rewritable macros</primary>
</indexterm>
<p oldrole="para">Soft macros (sometimes also called name-value pairs) are either built-in macros automatically generated from the log message (for example, ${HOST}), or custom user-created macros generated by using the syslog-ng pattern database or a CSV-parser. The SDATA fields of RFC5424-formatted log messages become soft macros as well. In contrast with hard macros, soft macros are writable and can be modified within <entity>abbrev</entity>, for example, using rewrite rules.</p>

<table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="note" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');"><col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;"></col><col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2"></col><tbody><tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1"><td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1"><p><img src="../../Resources/Images/Common/note.png"/></p></td><td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">NOTE: </span><p oldrole="para">It is also possible to set the value of built-in soft macros using parsers, for example, to set the ${HOST} macro from the message using a column of a CSV-parser.</p><p oldrole="para">The data extracted from the log messages using named pattern parsers in the pattern database are also soft macros.</p></td></tr></tbody></table>
<table cellspacing="0" class="TableStyle-NoteTable_Blue_DoNotEdit" oldrole="tip" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/NoteTable_Blue_DoNotEdit.css');"><col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column1" style="width: 0.3in;"></col><col class="TableStyle-NoteTable_Blue_DoNotEdit-Column-Column2"></col><tbody><tr class="TableStyle-NoteTable_Blue_DoNotEdit-Body-Body1"><td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyB-Column1-Body1"><p><img src="../../Resources/Images/Common/note.png"/></p></td><td class="TableStyle-NoteTable_Blue_DoNotEdit-BodyA-Column2-Body1"><span class="AllNoteStyles">TIP: </span><p oldrole="para">For the list of hard and soft macros, see <xref linkend="macros-hard-vs-soft"></xref>.</p></td></tr></tbody></table>
</li>
</ul>
<simplesect xml:id="message-size-and-encoding">
<title>Message size and encoding</title>
<indexterm>
<primary>message encoding</primary>
</indexterm>
<indexterm>
<primary>truncating messages</primary>
</indexterm>
<p oldrole="para">Internally, <entity>abbrev</entity> represents every message as UTF-8. The maximal length of the log messages is limited by the <span class="Code" oldrole="parameter">log-msg-size()</span> option: if a message is longer than this value, <entity>abbrev</entity> truncates the message at the location it reaches the <span class="Code" oldrole="parameter">log-msg-size()</span> value, and discards the rest of the message.</p>
<p oldrole="para">When encoding is set in a source (using the <span class="Code" oldrole="parameter">encoding()</span> option) and the message is longer (in bytes) than <span class="Code" oldrole="parameter">log-msg-size()</span> in UTF-8 representation, <entity>abbrev</entity> splits the message at an undefined location (because the conversion between different encodings is not trivial).</p>
</simplesect>

<MadCap:snippetBlock src="concepts-value-pairs.htm"></MadCap:snippetBlock>

<h2 name="concepts-things-to-consider">Things to consider when forwarding messages between <entity>abbrev</entity> hosts</h2>
<p oldrole="para">When you send your log messages from a <entity>abbrev</entity> client through the network to a <entity>abbrev</entity> server, you can use different protocols and options. Every combination has its advantages and disadvantages. The most important thing is to use matching protocols and options, so the server handles the incoming log messages properly.</p>
<p oldrole="para">In <entity>abbrev</entity> you can change many aspects of the network communication. First of all, there is the structure of the messages itself. Currently, <entity>abbrev</entity> supports two standard syslog protocols: the BSD (RFC3164) and the syslog (RFC5424) message format.</p>
<p oldrole="para">These RFCs describe the format and the structure of the log message, and add a (lightweight) framing around the messages. You can set this framing/structure by selecting the appropriate driver in <entity>abbrev</entity>. There are two drivers you can use: the <span class="Code" oldrole="parameter">network()</span> driver and the <span class="Code" oldrole="parameter">syslog()</span> driver. The <span class="Code" oldrole="parameter">syslog()</span> driver is for the syslog (RFC5424) protocol and the network() driver is for the BSD (RFC3164) protocol.</p>
<p oldrole="para">The <span class="Code" oldrole="parameter">tcp()</span> and <span class="Code" oldrole="parameter">udp()</span> drivers are now deprecated, they are essentially equivalent with the <span class="Code" oldrole="parameter">network(transport(tcp))</span> and <span class="Code" oldrole="parameter">network(transport(udp))</span> drivers.</p>
<p oldrole="para">In addition to selecting the driver to use, both drivers allow you to use different transport-layer protocols: TCP and UDP, and optionally also higher-level transport protocols: TLS (over TCP<phrase condition="pe">, and RLTP (optionally using TLS)</phrase>. To complicate things a bit more, you can configure the <span class="Code" oldrole="parameter">network()</span> driver (corresponding to the BSD (RFC3164) protocol) to send the messages in the syslog (RFC5424) format (but without the framing used in RFC5424) using the <span class="Code" oldrole="parameter">flag(syslog-protocol)</span> option.</p>
<p oldrole="para">Because some combination of drivers and options are invalid, you can use the following drivers and options as sources and as destinations:</p>
<ol oldrole="orderedlist">
<li oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter">syslog(transport(tcp))</span></p>
</li>
<li oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter">syslog(transport(udp))</span></p>
</li>
<li condition="pe6" oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter">syslog(transport(rltp))</span></p>
</li>
<li oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter">syslog(transport(tls))</span></p>
</li>
<li condition="pe6" oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter">syslog(transport(rltp(tls-required(yes)))</span></p>
</li>
<li oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter">network(transport(tcp))</span></p>
</li>
<li oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter">network(transport(udp))</span></p>
</li>
<li condition="pe6" oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter">network(transport(rltp))</span></p>
</li>
<li oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter">network(transport(tls))</span></p>
</li>
<li condition="pe6" oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter">network(transport(rltp(tls-required(yes)))</span></p>
</li>
<li oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter">network(transport(tcp) flag(syslog-protocol))</span></p>
</li>
<li oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter">network(transport(udp) flag(syslog-protocol))</span></p>
</li>
<li condition="pe6" oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter">network(transport(rltp)flag(syslog-protocol))</span></p>
</li>
<li oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter">network(transport(tls) flag(syslog-protocol))</span></p>
</li>
<li condition="pe6" oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter">network(transport(rltp(tls-required(yes)) flag(syslog-protocol))</span></p>
</li>
</ol>
<p oldrole="para">If you use the same driver and options in the destination of your <entity>abbrev</entity> client and the source of your <entity>abbrev</entity> server, everything should work as expected. Unfortunately there are some other combinations, that seem to work, but result in losing parts of the messages. The following table show the combinations:</p>
<table xml:id="table-syslog-ng-source-destination-combinations">
<title>Source-destination driver combinations</title>
<tgroup cols="10">
<thead>
<row>
<entry>Source \ Destination</entry>
<entry>syslog/tcp</entry>
<entry>syslog/udp</entry>
<entry>syslog/tls</entry>
<entry>network/tcp</entry>
<entry>network/udp</entry>
<entry>network/tls</entry>
<entry>network/tcp/flag</entry>
<entry>network/udp/flag</entry>
<entry>network/tls/flag</entry>
</row>
</thead>
<tbody>
<row>
<entry>syslog/tcp</entry>
<entry> <entity>#10004</entity> </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> ! </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> ! </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
</row>
<row>
<entry>syslog/udp</entry>
<entry> - </entry>
<entry> <entity>#10004</entity> </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry> ! </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry> ! </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
</row>
<row>
<entry>syslog/tls</entry>
<entry> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> <entity>#10004</entity> </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> ! </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> ! </entry>
<entry condition="pe6"> - </entry>
</row>
<row>
<entry>network/tcp</entry>
<entry> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> <entity>#10004</entity> </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> <entity>#10004</entity>? </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
</row>
<row>
<entry>network/udp</entry>
<entry> - </entry>
<entry> <entity>#10004</entity>? </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry> <entity>#10004</entity> </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry> <entity>#10004</entity>? </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
</row>
<row>
<entry>network/tls</entry>
<entry> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> <entity>#10004</entity> </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> <entity>#10004</entity>? </entry>
<entry condition="pe6"> - </entry>
</row>
<row>
<entry>network/tcp/flag</entry>
<entry> ! </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> ! </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> <entity>#10004</entity> </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
</row>
<row>
<entry>network/udp/flag</entry>
<entry> - </entry>
<entry> ! </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry> ! </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry> <entity>#10004</entity> </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
</row>
<row>
<entry>network/tls/flag</entry>
<entry> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> ! </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> ! </entry>
<entry condition="pe6"> - </entry>
<entry> - </entry>
<entry> - </entry>
<entry condition="pe6"> - </entry>
<entry> <entity>#10004</entity> </entry>
<entry condition="pe6"> - </entry>
</row>
</tbody>
</tgroup>
</table>
<ul oldrole="itemizedlist">
<li oldrole="listitem">
<p oldrole="para">- This method does not work. The logs will not get to the server.</p>
</li>
<li oldrole="listitem">
<p oldrole="para"><entity>#10004</entity> This method works.</p>
</li>
<li oldrole="listitem">
<p oldrole="para">! This method has some visible drawbacks. The logs go through, but some of the values are missing/misplaced/and so on.</p>
</li>
<li oldrole="listitem">
<p oldrole="para"><entity>#10004</entity>? This method seems to work, but it is not recommended because this can change in a future release.</p>
</li>
</ul>


<h2 name="concepts-commercial-version">Commercial version of syslog-ng</h2>
<p oldrole="para">The syslog-ng application has a commercial version available, called <entity>pe</entity> (<entity>peabbrev</entity>). The commercial version comes with well-tested features from its open source foundation, a number of extra features, enterprise-level support, as well as a ready-to-use log management appliance built on the strengths of <entity>pe</entity>.</p>
<simplesect>
<title>Exclusive features related to compliance</title>
<p oldrole="para">Collecting and analyzing log messages is required directly or indirectly by several regulations, frameworks, and standards, including the Sarbanes-Oxley Act (SOX), the Health Insurance and Portability Act (HIPAA), and the Payment Card Industry Data Security Standard (PCI-DSS). <entity>peabbrev</entity> provides a set of features that help you comply with regulations that require the central collection of log messages in a tamperproof way:</p>
<ul oldrole="itemizedlist">
<li oldrole="listitem">
<p oldrole="para">Logstore files enable you to store log messages securely in encrypted, compressed and timestamped binary files. From a compliance point of view, this serves a double purpose. Encryption guarantees the integrity of log messages so you can be sure that they have not been manipulated. Timestamping provides verifiable proof about the exact time when log messages arrived.</p>
</li>
<li oldrole="listitem">
<p oldrole="para"><trademark>Reliable Log Transfer Protocol</trademark> (<trademark>RLTP</trademark>) is a proprietary transport protocol that prevents message loss during connection breaks. When using this protocol, the sender detects which messages the receiver has successfully received (based on the acknowledgements returned by the receiver after having processed messages). If messages are lost during transfer, the sender resends the missing messages, starting from the last successfully received message. Therefore, messages are not duplicated at the receiving end in case of a connection break.</p>
</li>
</ul>
</simplesect>
<simplesect>
<title>Wide range of supported platforms with binary installers</title>
<p oldrole="para"><entity>pe</entity> comes with tested binary files that are available for a wide array of server platforms, reducing the time required for installation and maintenance. Support for a wide range of operating system and hardware platforms also make <entity>peabbrev</entity> an ideal choice to collect logs in massively heterogeneous environments.</p>
</simplesect>
<simplesect>
<title>Enterprise-level support services</title>
<p oldrole="para">As all commercial software, <entity>peabbrev</entity> also comes with various enterprise-level support packages, which means that you get immediate and pro-active assistance (24x7 if you choose a top-tier package), dedicated to resolving your issue as soon as possible when you experience problems.</p>
<p oldrole="para">For more information about <entity>pe</entity>, see <a href="https://goo.gl/cLBrpN">The <entity>pe</entity> Administrator Guide</a>.</p>
<!--FIXME: Once PE6 contents have been moved into PE7, do the following: 1. Uncomment next para. 2. Create a Google short link from the url in the link tag using: https://goo.gl/. ?? If all of this is unclear, ask Vanda. ??-->
<!--<para>For detailed instructions on how to upgrade from <entity>abbrev</entity> to <entity>peabbrev</entity>, see Section <citetitle>Upgrading from <entity>abbrev</entity> to <entity>peabbrev</entity></citetitle> in <link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.balabit.com/documents/syslog-ng-pe-7.0-guides/en/syslog-ng-pe-guide-admin/html/index.html#upgrading-from-ose-to-pe">The <entity>pe</entity> Administrator Guide</link>.</para>-->
</simplesect>
<simplesect>
<title><entity>ssb</entity>, ready-to-use log management appliance</title>
<p oldrole="para"><entity>ssb</entity> (<entity>ssbabbrev</entity>) is a log management appliance that is built on <entity>pe</entity>. It is a turnkey solution to manage your log data, meaning that no software installation is necessary. As <entity>ssbabbrev</entity> is available both as a virtual machine and a physical appliance, it is also easily scalable.</p>
<p oldrole="para"><entity>ssbabbrev</entity> provides a number of features that can add value for your use cases:</p>
<ul oldrole="itemizedlist">
<li oldrole="listitem">
<p oldrole="para">A web GUI that makes searching logs, as well as configuring and managing <entity>ssbabbrev</entity> itself easy:</p>
<ul oldrole="itemizedlist">
<li oldrole="listitem">
<p oldrole="para">The search interface allows you to use wildcards and Boolean operators to perform complex searches, and drill down on the results. You can gain a quick overview and pinpoint problems fast by generating ad-hoc charts from the distribution of the log messages.</p>
<p oldrole="para">In addition, you can easily create customized reports from the charts and statistics you create on the search interface to demonstrate compliance with standards and regulations such as PCI-DSS, ISO 27001, SOX and HIPAA.</p>
</li>
<li oldrole="listitem">
<p oldrole="para">Configuring <entity>ssbabbrev</entity> is done through the user interface. All of the flexible filtering, classification and routing features in the <entity>ose</entity> and <entity>pe</entity> can be configured with it. Access and authentication policies can be set to integrate with Microsoft Active Directory, LDAP and Radius servers. The web interface is accessible through a network interface dedicated to management traffic. This management interface is also used for backups, sending alerts, and other administrative traffic.</p>
</li>
</ul>
</li>
<li oldrole="listitem">
<p oldrole="para">High availability support to ensure continuous log collection in business-critical environments.</p>
</li>
</ul>
<p oldrole="para">For further details about <entity>ssb</entity>, see <a href="https://goo.gl/cbxYNx">The <entity>ssb</entity> Administrator Guide</a>.</p>
</simplesect>
<simplesect>
<title>Upgrading from <entity>oseabbrev</entity> to <entity>peabbrev</entity></title>
<p oldrole="para">If you wish to upgrade from <entity>oseabbrev</entity> to <entity>peabbrev</entity>, read the blog post <a href="https://syslog-ng.com/blog/upgrading-from-syslog-ng-open-source-to-premium-edition/">Upgrading from <entity>oseabbrev</entity> to <entity>peabbrev</entity></a> for instructions and tips.</p>
</simplesect>

</body></html>
