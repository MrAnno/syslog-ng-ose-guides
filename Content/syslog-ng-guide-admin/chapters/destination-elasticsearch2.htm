<?xml version="1.0" encoding="UTF-8"?>

<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><body name="configuring-destinations-elasticsearch2" oldrole="section">
<h1 name="configuring-destinations-elasticsearch2" version="5.0" xmlns="http://docbook.org/ns/docbook"><span class="Code" oldrole="parameter">elasticsearch2</span>: Sending logs directly to Elasticsearch and Kibana 2.0 or higher</h1>
<MadCap:keyword term="destination drivers:[&lt;span class=&quot;Code&quot; oldrole=&quot;parameter&quot;&gt;java()&lt;/span&gt;, ' driver']"></MadCap:keyword>
<MadCap:keyword term='destination drivers:[&lt;span class="Code" oldrole="parameter"&gt;elasticsearch2&lt;/span&gt;]'></MadCap:keyword>
<p oldrole="para">Starting with version <MadCap:conditionaltext MadCap:conditions="pe">5.6</MadCap:conditionaltext><MadCap:conditionaltext MadCap:conditions="ose">3.7</MadCap:conditionaltext> of <MadCap:variable name="General.abbrev"></MadCap:variable> can directly send log messages to <a href="https://www.elastic.co/products/elasticsearch">Elasticsearch</a>, allowing you to search and analyze your data in real time, and visualize it with <a href="https://www.elastic.co/products/kibana">Kibana</a>.</p>
<p oldrole="para">Note the following limitations when using the <MadCap:variable name="General.abbrev"></MadCap:variable> <span class="Code" oldrole="parameter">elasticsearch2</span> destination:</p>
<ul oldrole="itemizedlist">
<MadCap:snippetBlock src="../../shared/chunk/listitem-java-supported-platforms.htm"></MadCap:snippetBlock>
<li oldrole="listitem">
<p oldrole="para">Since <MadCap:variable name="General.abbrev"></MadCap:variable> uses Java libraries, the <span class="Code" oldrole="parameter">elasticsearch2</span> destination has significant memory usage.</p>
</li>
<MadCap:snippetBlock src="../../shared/chunk/listitem-java-internal-messages.htm"></MadCap:snippetBlock>
</ul>
<h6 oldrole="formalpara">Declaration:</h6>

<pre class="Code" oldrole="synopsis">@module mod-java
@include "scl.conf"

elasticsearch2(
    index("syslog-ng")
    type("test")
    cluster("syslog-ng")
);</pre>

<h6 name="example-destination-elasticsearch2" oldrole="example">Example: Sending log data to Elasticsearch version 2.x and above</h6>
<p oldrole="para">The following example defines an <span class="Code" oldrole="parameter">elasticsearch2</span> destination that sends messages in transport mode to an Elasticsearch server running on the localhost, using only the required parameters.</p>
<pre class="Code" oldrole="synopsis">@module mod-java
@include "scl.conf"

destination d_elastic {
  elasticsearch2(
    index("syslog-ng")
    type("test")
  );
};
</pre>
<p oldrole="para">The following example sends 10000 messages in a batch, in transport mode, and includes a custom unique ID for each message.</p>
<pre class="Code" oldrole="synopsis">@module mod-java
@include "scl.conf"

options {
  threaded(yes);
  use-uniqid(yes);
};

source s_syslog {
  syslog();
};

destination d_elastic {
  elasticsearch2(
    index("syslog-ng")
    type("test")
    cluster("syslog-ng")
    client-mode("transport")
    custom-id("${UNIQID}")
    flush-limit("10000")
  );
};

log {
  source(s_syslog);
  destination(d_elastic);
  flags(flow-control);
};</pre>


<h6 condition="ose" name="example-destination-elasticsearch2-http" oldrole="example">Example: Sending log data to Elasticsearch using the HTTP REST API</h6>
<p oldrole="para">The following example send messages to Elasticsearch over HTTP using its REST API:</p>
<pre class="Code" oldrole="synopsis">@include "scl.conf"

source s_network {
    network(port(5555));
};

destination d_elastic {
    elasticsearch2(
        client-mode("http")
        cluster("es-syslog-ng")
        index("x201")
        cluster-url("http://192.168.33.10:9200")
        type("slng_test_type")
        flush-limit("0")
    );
};

log {
   source(s_network);
   destination(d_elastic);
   flags(flow-control);
};</pre>
<MadCap:snippetBlock src="../../shared/chunk/example-elasticsearch-https-verifycert-clientcert.htm"></MadCap:snippetBlock>

<ul oldrole="itemizedlist">
<li oldrole="listitem">
<p oldrole="para">To install the software required for the <span class="Code" oldrole="parameter">elasticsearch2</span> destination, see <MadCap:xref href="destination-elasticsearch2-prerequisites.htm#destination-elasticsearch2-prerequisites"></MadCap:xref>.</p>
</li>
<li oldrole="listitem">
<p oldrole="para">For details on how the <span class="Code" oldrole="parameter">elasticsearch2</span> destination works, see <MadCap:xref href="destination-elasticsearch2.htm#destination-elasticsearch2-interaction"></MadCap:xref>.</p>
</li>
<li oldrole="listitem">
<p oldrole="para">For the list of options, see <MadCap:xref href="destination-elasticsearch2.htm#reference-destination-elasticsearch2"></MadCap:xref>.</p>
</li>
</ul>
<p condition="ose" oldrole="para">The <span class="Code" oldrole="parameter">elasticsearch2()</span> driver is actually a reusable configuration snippet configured to receive log messages using the Java language-binding of <MadCap:variable name="General.abbrev"></MadCap:variable>. For details on using or writing such configuration snippets, see <MadCap:xref href="chapter-configuration-file.htm#config-blocks"></MadCap:xref>. You can find the source of the elasticsearch configuration snippet on <a href="https://github.com/balabit/syslog-ng/blob/master/scl/elasticsearch/plugin.conf">GitHub</a>. For details on extending <MadCap:variable name="General.abbrev"></MadCap:variable> in Java, see the <a href="https://syslog-ng.gitbooks.io/getting-started/content/chapters/chapter_5/section_2.html">Getting started with syslog-ng development</a> guide.</p>
<MadCap:snippetBlock src="destination-elasticsearch2-prerequisites.htm"></MadCap:snippetBlock>
<h2 name="destination-elasticsearch2-interaction">How <MadCap:variable name="General.abbrev"></MadCap:variable> interacts with Elasticsearch</h2>
<p oldrole="para">The <MadCap:variable name="General.abbrev"></MadCap:variable> application sends the log messages to the official Elasticsearch client library, which forwards the data to the Elasticsearch nodes. The way <MadCap:variable name="General.abbrev"></MadCap:variable> interacts with Elasticsearch is described in the following steps.</p>
<ul oldrole="itemizedlist">
<li oldrole="listitem">
<p oldrole="para">After <MadCap:variable name="General.abbrev"></MadCap:variable> is started and the first message arrives to the <span class="Code" oldrole="parameter">elasticsearch2</span> destination, the <span class="Code" oldrole="parameter">elasticsearch2</span> destination tries to connect to the Elasticsearch server or cluster. If the connection fails, <MadCap:variable name="General.abbrev"></MadCap:variable> will repeatedly attempt to connect again after the period set in <span class="Code" oldrole="parameter">time-reopen()</span> expires.</p>
</li>
<li oldrole="listitem">
<p oldrole="para">If the connection is established, <MadCap:variable name="General.abbrev"></MadCap:variable> sends JSON-formatted messages to Elasticsearch.</p>
<MadCap:snippetBlock src="../../shared/chunk/option-destination-elasticsearch-flush-limit-description.htm"></MadCap:snippetBlock>
</li>
<li oldrole="listitem">
<MadCap:snippetBlock src="../../shared/chunk/option-destination-elasticsearch-timezone.htm"></MadCap:snippetBlock>
</li>
</ul>
<h2 name="destination-elasticsearch2-client-modes">Client modes</h2>
<p oldrole="para">The <MadCap:variable name="General.abbrev"></MadCap:variable> application can interact with Elasticsearch in the following modes of operation: <MadCap:conditionaltext MadCap:conditions="ose">http, https, </MadCap:conditionaltext>node,<MadCap:conditionaltext MadCap:conditions="ose"> searchguard,</MadCap:conditionaltext> and transport.</p>
<MadCap:snippetBlock src="../../shared/chunk/option-destination-elasticsearch-client-mode-description.htm"></MadCap:snippetBlock>
<MadCap:snippetBlock src="syslog-ng-elasticsearch2-search-guard.htm"></MadCap:snippetBlock>
<h2 name="reference-destination-elasticsearch2">Elasticsearch2 destination options</h2>
<MadCap:keyword term="destination drivers:[&lt;span class=&quot;Code&quot; oldrole=&quot;parameter&quot;&gt;java()&lt;/span&gt;, ' driver']"></MadCap:keyword>
<MadCap:keyword term='destination drivers:[&lt;span class="Code" oldrole="parameter"&gt;elasticsearch2&lt;/span&gt;]'></MadCap:keyword>
<p oldrole="para">The <span class="Code" oldrole="parameter">elasticsearch2</span> destination can directly send log messages to <a href="https://www.elastic.co/products/elasticsearch">Elasticsearch</a>, allowing you to search and analyze your data in real time, and visualize it with <a href="https://www.elastic.co/products/kibana">Kibana</a>. The <span class="Code" oldrole="parameter">elasticsearch2</span> destination has the following options.</p>
<h6 oldrole="formalpara">Required options:</h6>

<p oldrole="para">The following options are required: <span class="Code" oldrole="parameter">index()</span>, <span class="Code" oldrole="parameter">type()</span>. In node mode, either the <span class="Code" oldrole="parameter">cluster()</span> or the <span class="Code" oldrole="parameter">resource()</span> option is required as well. Note that to use <span class="Code" oldrole="parameter">elasticsearch2</span>, you must add the following lines to the beginning of your <MadCap:variable name="General.abbrev"></MadCap:variable> configuration:</p>
<pre class="Code" oldrole="synopsis">@module mod-java
@include "scl.conf"</pre>

<MadCap:snippetBlock src="../../shared/chunk/option-destination-java-class-path.htm"></MadCap:snippetBlock>
<p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> Include the path to the directory where you copied the required libraries (see <MadCap:xref href="destination-elasticsearch2-prerequisites.htm#destination-elasticsearch2-prerequisites"></MadCap:xref>), for example, <span class="Code" oldrole="userinput">client-lib-dir(/user/share/elasticsearch-2.2.0/lib)</span>.</p>


<h6 name="elasticsearch2-option-elasticsearch2-client-mode" oldrole="simplesect">client-mode()</h6>
<MadCap:keyword term="client-mode():['elasticsearch2']"></MadCap:keyword>
<MadCap:keyword term="elasticsearch2:['client-mode']"></MadCap:keyword>
<table cellspacing="0" class="RuledTableWithHeading_DoNotEdit" colsep="0" frame="topbot" rowsep="0" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');">


<tbody>
<tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
<td class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">Type:</td>
<td class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1"><phrase condition="ose">http | https | </phrase>transport | node<phrase condition="ose"> | searchguard</phrase>
</td>
</tr>
<tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
<td class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">Default:</td>
<td class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">node</td>
</tr>
</tbody>

<col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" style="width: 0.3in;"></col></table>
<p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> Specifies the client mode used to connect to the Elasticsearch server, for example, <span class="Code" oldrole="userinput">client-mode("node")</span>.</p>
<MadCap:snippetBlock src="../../shared/chunk/option-destination-elasticsearch-client-mode-description.htm"></MadCap:snippetBlock>

<simplesect xml:id="elasticsearch2-option-elasticsearch2-cluster">
<title>cluster()</title>
<indexterm type="parameter">
<primary>cluster()</primary>
<secondary>elasticsearch2</secondary>
</indexterm>
<indexterm type="parameter">
<primary>elasticsearch2</primary>
<secondary>cluster</secondary>
</indexterm>
<table cellspacing="0" class="RuledTableWithHeading_DoNotEdit" colsep="0" frame="topbot" rowsep="0" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');">


<tbody>
<tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
<td class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">Type:</td>
<td class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">string</td>
</tr>
<tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
<td class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">Default:</td>
<td class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">N/A</td>
</tr>
</tbody>

<col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" style="width: 0.3in;"></col></table>
<p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> Specifies the name or the Elasticsearch cluster, for example, <span class="Code" oldrole="userinput">cluster("my-elasticsearch-cluster")</span>. Optionally, you can specify the name of the cluster in the Elasticsearch resource file. For details, see <xref linkend="elasticsearch2-option-elasticsearch2-resource"></xref>.</p>
</simplesect>
<simplesect xml:id="elasticsearch2-option-elasticsearch2-cluster-url">
<MadCap:snippetBlock src="../../shared/chunk/option-destination-elasticsearch-cluster-url.htm"></MadCap:snippetBlock>
</simplesect>
<simplesect xml:id="elasticsearch2-option-elasticsearch2-concurrent-requests">
<title>concurrent-requests()</title>
<indexterm type="parameter">
<primary>concurrent-requests()</primary>
<secondary>elasticsearch2</secondary>
</indexterm>
<indexterm type="parameter">
<primary>elasticsearch2</primary>
<secondary>concurrent-requests</secondary>
</indexterm>
<table cellspacing="0" class="RuledTableWithHeading_DoNotEdit" colsep="0" frame="topbot" rowsep="0" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/RuledTableWithHeading_DoNotEdit.css');">


<tbody>
<tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
<td class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">Type:</td>
<td class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">number</td>
</tr>
<tr class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">
<td class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">Default:</td>
<td class="TableStyle-RuledTableWithHeading_DoNotEdit-Body-Body1">0</td>
</tr>
</tbody>

<col class="TableStyle-RuledTableWithHeading_DoNotEdit-Column-Column1" style="width: 0.3in;"></col></table>
<indexterm>
<primary>elasticsearch2</primary>
<secondary>performance</secondary>
</indexterm>
<p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> The number of concurrent (simultaneous) requests that <entity>abbrev</entity> sends to the Elasticsearch server. Set this option to 1 or higher to increase performance. When using the <span class="Code" oldrole="parameter">concurrent-requests()</span> option, make sure that the <span class="Code" oldrole="parameter">flush-limit()</span> option is higher than one, otherwise it will not have any noticeable effect. For details, see <xref linkend="elasticsearch2-option-elasticsearch2-flush-limit"></xref>.</p>
<table cellspacing="0" class="TableStyle-NoteTable_Yellow_DoNotEdit" oldrole="warning" style="width: 100%;mc-table-style: url('../../Resources/TableStyles/NoteTable_Yellow_DoNotEdit.css');"><col class="TableStyle-NoteTable_Yellow_DoNotEdit-Column-Column1" style="width: 0.3in;"></col><col class="TableStyle-NoteTable_Yellow_DoNotEdit-Column-Column2"></col><tbody><tr class="TableStyle-NoteTable_Yellow_DoNotEdit-Body-Body1"><td class="TableStyle-NoteTable_Yellow_DoNotEdit-BodyB-Column1-Body1"><p><img src="../../Resources/Images/Common/caution.png"/></p></td><td class="TableStyle-NoteTable_Yellow_DoNotEdit-BodyA-Column2-Body1"><span class="Yellow">Caution: </span><p oldrole="para">Hazard of data loss! Using the <span class="Code" oldrole="parameter">concurrent-requests()</span> option increases the number of messages lost in case the Elasticsearch server becomes unaccessible.</p></td></tr></tbody></table>
</simplesect>
<simplesect xml:id="elasticsearch2-option-elasticsearch2-custom-id">
<title>custom-id()</title>
<indexterm type="parameter">
<primary>custom-id()</primary>
<secondary>elasticsearch2</secondary>
</indexterm>
<indexterm type="parameter">
<primary>elasticsearch2</primary>
<secondary>custom-id</secondary>
</indexterm>
<informaltable colsep="0" frame="topbot" rowsep="0">
<tgroup cols="2">
<colspec colnum="1" colwidth="40pt"></colspec>
<tbody>
<row>
<entry>Type:</entry>
<entry>template or template function</entry>
</row>
<row>
<entry>Default:</entry>
<entry>N/A</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> Use this option to specify a custom ID for the records inserted into Elasticsearch. If this option is not set, the Elasticsearch server automatically generates and ID for the message. For example: <span class="Code" oldrole="userinput">custom-id(${UNIQID})</span> (Note that to use the <span class="Code" oldrole="userinput">${UNIQID}</span> macro, the <span class="Code" oldrole="parameter">use-uniqid()</span> global option must be enabled. For details, see <xref linkend="global-use-uniqid"></xref>.)</p>
</simplesect>
<simplesect>
<MadCap:snippetBlock src="../../shared/chunk/option-destination-diskbuffer.htm"></MadCap:snippetBlock>
</simplesect>
<simplesect xml:id="elasticsearch2-option-elasticsearch2-flush-limit">
<title>flush-limit()</title>
<indexterm type="parameter">
<primary>flush-limit()</primary>
<secondary>elasticsearch2</secondary>
</indexterm>
<indexterm type="parameter">
<primary>elasticsearch2</primary>
<secondary>flush-limit</secondary>
</indexterm>
<informaltable colsep="0" frame="topbot" rowsep="0">
<tgroup cols="2">
<colspec colnum="1" colwidth="40pt"></colspec>
<tbody>
<row>
<entry>Type:</entry>
<entry>number</entry>
</row>
<row>
<entry>Default:</entry>
<entry>5000</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<indexterm>
<primary>elasticsearch2</primary>
<secondary>performance</secondary>
</indexterm>
<p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> The number of messages that <entity>abbrev</entity> sends to the Elasticsearch server in a single batch.</p>
<MadCap:snippetBlock src="../../shared/chunk/option-destination-elasticsearch-flush-limit-description.htm"></MadCap:snippetBlock>
</simplesect>
<simplesect>
<MadCap:snippetBlock src="../../shared/chunk/option-destination-frac-digits.htm"></MadCap:snippetBlock>
</simplesect>
<simplesect condition="ose" xml:id="elasticsearch2-option-elasticsearch2-http-auth-type">
<title>http-auth-type()</title>
<indexterm type="parameter">
<primary>http-auth-type()</primary>
<secondary>elasticsearch2</secondary>
</indexterm>
<indexterm type="parameter">
<primary>elasticsearch2</primary>
<secondary>http-auth-type</secondary>
</indexterm>
<indexterm>
<primary>authentication</primary>
<secondary>Elasticsearch</secondary>
</indexterm>
<informaltable colsep="0" frame="topbot" rowsep="0">
<tgroup cols="2">
<colspec colnum="1" colwidth="40pt"></colspec>
<tbody>
<row>
<entry>Type:</entry>
<entry>none | basic | clientcert</entry>
</row>
<row>
<entry>Default:</entry>
<entry>none</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> Determines how <entity>abbrev</entity> authenticates to the Elasticsearch server. Depending on the value of this option, you might have to set other options as well. Possible values:</p>
<ul oldrole="itemizedlist">
<li oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter">none</span>: Connect to the Elasticsearch server without authentication.</p>
</li>
<li oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter">basic</span>: Use password authentication. Also set the <a href="destination-elasticsearch2.htm"><span class="Code" oldrole="parameter">http-auth-type-basic-username</span></a> and <a href="destination-elasticsearch2.htm"><span class="Code" oldrole="parameter">http-auth-type-basic-password</span></a> options.</p>
</li>
<li oldrole="listitem">
<p oldrole="para"><span class="Code" oldrole="parameter">clientcert</span>: Use a certificate to authenticate. The certificate must be available in a Java keystore. Also set the <a href="destination-elasticsearch2.htm"><span class="Code" oldrole="parameter">java-keystore-filepath</span></a> and <a href="destination-elasticsearch2.htm"><span class="Code" oldrole="parameter">java-keystore-password</span></a> options.</p>
</li>
</ul>
<p oldrole="para">This option is used only in HTTPS mode: <span class="Code" oldrole="userinput">client-mode("https")</span>, and is available in <entity>abbrev</entity> version <phrase condition="ose">3.10</phrase><phrase condition="pe">7.0.3</phrase> and newer.</p>
<example xml:id="elasticsearch2-https-auth-examples">
<title>HTTPS authentication examples</title>
<p oldrole="para">The following simple examples show the different authentication modes.</p>
<MadCap:snippetBlock src="../../shared/chunk/example-elasticsearch-https-password.htm"></MadCap:snippetBlock>
<MadCap:snippetBlock src="../../shared/chunk/example-elasticsearch-https-clientcert.htm"></MadCap:snippetBlock>
<MadCap:snippetBlock src="../../shared/chunk/example-elasticsearch-https-verifycert.htm"></MadCap:snippetBlock>
<MadCap:snippetBlock src="../../shared/chunk/example-elasticsearch-https-verifycert-clientcert.htm"></MadCap:snippetBlock>
</example>
</simplesect>
<simplesect condition="ose" xml:id="elasticsearch2-option-elasticsearch2-http-auth-type-basic-password">
<title>http-auth-type-basic-password()</title>
<indexterm type="parameter">
<primary>http-auth-type-basic-password()</primary>
<secondary>elasticsearch2</secondary>
</indexterm>
<indexterm type="parameter">
<primary>elasticsearch2</primary>
<secondary>http-auth-type-basic-password</secondary>
</indexterm>
<indexterm>
<primary>authentication</primary>
<secondary>Elasticsearch</secondary>
</indexterm>
<informaltable colsep="0" frame="topbot" rowsep="0">
<tgroup cols="2">
<colspec colnum="1" colwidth="40pt"></colspec>
<tbody>
<row>
<entry>Type:</entry>
<entry>string</entry>
</row>
<row>
<entry>Default:</entry>
<entry>N/A</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> The password to use for password-authentication on the Elasticsearch server. You must also set the <a href="destination-elasticsearch2.htm"><span class="Code" oldrole="parameter">http-auth-type-basic-username</span></a> option.</p>
<p oldrole="para">This option is used only in HTTPS mode with basic authentication: <span class="Code" oldrole="userinput">client-mode("https")</span> and <span class="Code" oldrole="userinput">http-auth-type("basic")</span>, and is available in <entity>abbrev</entity> version <phrase condition="ose">3.10</phrase><phrase condition="pe">7.0.3</phrase> and newer.</p>
<MadCap:snippetBlock src="../../shared/chunk/example-elasticsearch-https-password.htm"></MadCap:snippetBlock>
</simplesect>
<simplesect condition="ose" xml:id="elasticsearch2-option-elasticsearch2-http-auth-type-basic-username">
<title>http-auth-type-basic-username()</title>
<indexterm type="parameter">
<primary>http-auth-type-basic-username()</primary>
<secondary>elasticsearch2</secondary>
</indexterm>
<indexterm type="parameter">
<primary>elasticsearch2</primary>
<secondary>http-auth-type-basic-username</secondary>
</indexterm>
<indexterm>
<primary>authentication</primary>
<secondary>Elasticsearch</secondary>
</indexterm>
<informaltable colsep="0" frame="topbot" rowsep="0">
<tgroup cols="2">
<colspec colnum="1" colwidth="40pt"></colspec>
<tbody>
<row>
<entry>Type:</entry>
<entry>string</entry>
</row>
<row>
<entry>Default:</entry>
<entry>N/A</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> The username to use for password-authentication on the Elasticsearch server. You must also set the <a href="destination-elasticsearch2.htm"><span class="Code" oldrole="parameter">http-auth-type-basic-password</span></a> option.</p>
<p oldrole="para">This option is used only in HTTPS mode with basic authentication: <span class="Code" oldrole="userinput">client-mode("https")</span> and <span class="Code" oldrole="userinput">http-auth-type("basic")</span>, and is available in <entity>abbrev</entity> version <phrase condition="ose">3.10</phrase><phrase condition="pe">7.0.3</phrase> and newer.</p>
<MadCap:snippetBlock src="../../shared/chunk/example-elasticsearch-https-password.htm"></MadCap:snippetBlock>
</simplesect>
<simplesect xml:id="elasticsearch2-option-elasticsearch2-index">
<title>index()</title>
<indexterm type="parameter">
<primary>index()</primary>
<secondary>elasticsearch2</secondary>
</indexterm>
<indexterm type="parameter">
<primary>elasticsearch2</primary>
<secondary>index</secondary>
</indexterm>
<informaltable colsep="0" frame="topbot" rowsep="0">
<tgroup cols="2">
<colspec colnum="1" colwidth="40pt"></colspec>
<tbody>
<row>
<entry>Type:</entry>
<entry>string</entry>
</row>
<row>
<entry>Default:</entry>
<entry>N/A</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> Name of the Elasticsearch index to store the log messages. You can use macros and templates as well.</p>
</simplesect>
<simplesect condition="ose" xml:id="elasticsearch2-option-elasticsearch2-java-keystore-filepath">
<title>java-keystore-filepath()</title>
<indexterm type="parameter">
<primary>java-keystore-filepath()</primary>
<secondary>elasticsearch2</secondary>
</indexterm>
<indexterm type="parameter">
<primary>elasticsearch2</primary>
<secondary>java-keystore-filepath</secondary>
</indexterm>
<indexterm>
<primary>authentication</primary>
<secondary>Elasticsearch</secondary>
</indexterm>
<indexterm>
<primary>certificate authentication</primary>
<secondary>Elasticsearch</secondary>
</indexterm>
<informaltable colsep="0" frame="topbot" rowsep="0">
<tgroup cols="2">
<colspec colnum="1" colwidth="40pt"></colspec>
<tbody>
<row>
<entry>Type:</entry>
<entry>string</entry>
</row>
<row>
<entry>Default:</entry>
<entry>N/A</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> Path to the Java keystore file that stores the certificate that <entity>abbrev</entity> uses to authenticate on the Elasticsearch server. You must also set the <a href="destination-elasticsearch2.htm"><span class="Code" oldrole="parameter">java-keystore-password</span></a> option.</p>
<MadCap:snippetBlock src="../../shared/chunk/example-elasticsearch-https-java-keystore-import.htm"></MadCap:snippetBlock>
<p oldrole="para">This option is used only in HTTPS mode with basic authentication: <span class="Code" oldrole="userinput">client-mode("https")</span> and <span class="Code" oldrole="userinput">http-auth-type("clientcert")</span>, and is available in <entity>abbrev</entity> version <phrase condition="ose">3.10</phrase><phrase condition="pe">7.0.3</phrase> and newer.</p>
<MadCap:snippetBlock src="../../shared/chunk/example-elasticsearch-https-clientcert.htm"></MadCap:snippetBlock>
<MadCap:snippetBlock src="../../shared/chunk/example-elasticsearch-https-verifycert-clientcert.htm"></MadCap:snippetBlock>
</simplesect>
<simplesect condition="ose" xml:id="elasticsearch2-option-elasticsearch2-java-keystore-password">
<title>java-keystore-password()</title>
<indexterm type="parameter">
<primary>java-keystore-password()</primary>
<secondary>elasticsearch2</secondary>
</indexterm>
<indexterm type="parameter">
<primary>elasticsearch2</primary>
<secondary>java-keystore-password</secondary>
</indexterm>
<indexterm>
<primary>authentication</primary>
<secondary>Elasticsearch</secondary>
</indexterm>
<indexterm>
<primary>certificate authentication</primary>
<secondary>Elasticsearch</secondary>
</indexterm>
<informaltable colsep="0" frame="topbot" rowsep="0">
<tgroup cols="2">
<colspec colnum="1" colwidth="40pt"></colspec>
<tbody>
<row>
<entry>Type:</entry>
<entry>string</entry>
</row>
<row>
<entry>Default:</entry>
<entry>N/A</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> The password of the Java keystore file set in the <a href="destination-elasticsearch2.htm"><span class="Code" oldrole="parameter">java-keystore-filepath</span></a> option.</p>
<MadCap:snippetBlock src="../../shared/chunk/example-elasticsearch-https-java-keystore-import.htm"></MadCap:snippetBlock>
<p oldrole="para">This option is used only in HTTPS mode with basic authentication: <span class="Code" oldrole="userinput">client-mode("https")</span> and <span class="Code" oldrole="userinput">http-auth-type("clientcert")</span>, and is available in <entity>abbrev</entity> version <phrase condition="ose">3.10</phrase><phrase condition="pe">7.0.3</phrase> and newer.</p>
<MadCap:snippetBlock src="../../shared/chunk/example-elasticsearch-https-clientcert.htm"></MadCap:snippetBlock>
<MadCap:snippetBlock src="../../shared/chunk/example-elasticsearch-https-verifycert-clientcert.htm"></MadCap:snippetBlock>
</simplesect>
<simplesect condition="ose" xml:id="elasticsearch2-option-elasticsearch2-java-truststore-filepath">
<title>java-truststore-filepath()</title>
<indexterm type="parameter">
<primary>java-truststore-filepath()</primary>
<secondary>elasticsearch2</secondary>
</indexterm>
<indexterm type="parameter">
<primary>elasticsearch2</primary>
<secondary>java-truststore-filepath</secondary>
</indexterm>
<indexterm>
<primary>authentication</primary>
<secondary>Elasticsearch</secondary>
</indexterm>
<indexterm>
<primary>certificate authentication</primary>
<secondary>Elasticsearch</secondary>
</indexterm>
<informaltable colsep="0" frame="topbot" rowsep="0">
<tgroup cols="2">
<colspec colnum="1" colwidth="40pt"></colspec>
<tbody>
<row>
<entry>Type:</entry>
<entry>string</entry>
</row>
<row>
<entry>Default:</entry>
<entry>N/A</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> Path to the Java keystore file that stores the CA certificate that <entity>abbrev</entity> uses to verify the certificate of the Elasticsearch server. You must also set the <a href="destination-elasticsearch2.htm"><span class="Code" oldrole="parameter">java-truststore-password</span></a> option.</p>
<p oldrole="para">If you do not set the <span class="Code" oldrole="parameter">java-truststore-filepath</span> option, <entity>abbrev</entity> does accepts any certificate that the Elasticsearch server shows. In this case, the identity of the server is not verified, only the connection is encrypted.</p>
<MadCap:snippetBlock src="../../shared/chunk/example-elasticsearch-https-java-keystore-import.htm"></MadCap:snippetBlock>
<p oldrole="para">This option is used only in HTTPS mode: <span class="Code" oldrole="userinput">client-mode("https")</span>, and is available in <entity>abbrev</entity> version <phrase condition="ose">3.10</phrase><phrase condition="pe">7.0.3</phrase> and newer.</p>
<MadCap:snippetBlock src="../../shared/chunk/example-elasticsearch-https-verifycert.htm"></MadCap:snippetBlock>
<MadCap:snippetBlock src="../../shared/chunk/example-elasticsearch-https-verifycert-clientcert.htm"></MadCap:snippetBlock>
</simplesect>
<simplesect condition="ose" xml:id="elasticsearch2-option-elasticsearch2-java-truststore-password">
<title>java-truststore-password()</title>
<indexterm type="parameter">
<primary>java-truststore-password()</primary>
<secondary>elasticsearch2</secondary>
</indexterm>
<indexterm type="parameter">
<primary>elasticsearch2</primary>
<secondary>java-truststore-password</secondary>
</indexterm>
<indexterm>
<primary>authentication</primary>
<secondary>Elasticsearch</secondary>
</indexterm>
<indexterm>
<primary>certificate authentication</primary>
<secondary>Elasticsearch</secondary>
</indexterm>
<informaltable colsep="0" frame="topbot" rowsep="0">
<tgroup cols="2">
<colspec colnum="1" colwidth="40pt"></colspec>
<tbody>
<row>
<entry>Type:</entry>
<entry>string</entry>
</row>
<row>
<entry>Default:</entry>
<entry>N/A</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> The password of the Java truststore file set in the <a href="destination-elasticsearch2.htm"><span class="Code" oldrole="parameter">java-truststore-filepath</span></a> option.</p>
<MadCap:snippetBlock src="../../shared/chunk/example-elasticsearch-https-java-keystore-import.htm"></MadCap:snippetBlock>
<p oldrole="para">This option is used only in HTTPS mode: <span class="Code" oldrole="userinput">client-mode("https")</span>, and is available in <entity>abbrev</entity> version <phrase condition="ose">3.10</phrase><phrase condition="pe">7.0.3</phrase> and newer.</p>
<MadCap:snippetBlock src="../../shared/chunk/example-elasticsearch-https-verifycert.htm"></MadCap:snippetBlock>
<MadCap:snippetBlock src="../../shared/chunk/example-elasticsearch-https-verifycert-clientcert.htm"></MadCap:snippetBlock>
</simplesect>
<simplesect xml:id="elasticsearch-2-destination-jvm-options">
<MadCap:snippetBlock src="../../shared/chunk/option-destination-jvm-options.htm"></MadCap:snippetBlock>
</simplesect>
<simplesect>
<MadCap:snippetBlock src="../../shared/chunk/option-destination-log-fifo-size.htm"></MadCap:snippetBlock>
</simplesect>
<simplesect>
<MadCap:snippetBlock src="../../shared/chunk/option-destination-on-error.htm"></MadCap:snippetBlock>
</simplesect>
<simplesect xml:id="elasticsearch2-option-elasticsearch2-port">
<title>port()</title>
<indexterm type="parameter">
<primary>port()</primary>
<secondary>elasticsearch2</secondary>
</indexterm>
<indexterm type="parameter">
<primary>elasticsearch2</primary>
<secondary>port</secondary>
</indexterm>
<informaltable colsep="0" frame="topbot" rowsep="0">
<tgroup cols="2">
<colspec colnum="1" colwidth="40pt"></colspec>
<tbody>
<row>
<entry>Type:</entry>
<entry>number</entry>
</row>
<row>
<entry>Default:</entry>
<entry>9300</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> The port number of the Elasticsearch server. This option is used only in transport mode: <span class="Code" oldrole="userinput">client-mode("transport")</span></p>
</simplesect>
<simplesect>
<MadCap:snippetBlock src="../../shared/chunk/option-destination-retries.htm"></MadCap:snippetBlock>
</simplesect>
<simplesect xml:id="elasticsearch2-option-elasticsearch2-resource">
<title>resource()</title>
<indexterm type="parameter">
<primary>resource()</primary>
<secondary>elasticsearch2</secondary>
</indexterm>
<indexterm type="parameter">
<primary>elasticsearch2</primary>
<secondary>resource</secondary>
</indexterm>
<informaltable colsep="0" frame="topbot" rowsep="0">
<tgroup cols="2">
<colspec colnum="1" colwidth="40pt"></colspec>
<tbody>
<row>
<entry>Type:</entry>
<entry>string</entry>
</row>
<row>
<entry>Default:</entry>
<entry>N/A</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> The list of Elasticsearch resources to load, separated by semicolons. For example, <span class="Code" oldrole="userinput">resource("/home/user/elasticsearch/elasticsearch.yml;/home/user/elasticsearch/elasticsearch2.yml")</span>.</p>
</simplesect>
<simplesect xml:id="elasticsearch2-option-elasticsearch2-server">
<title>server()</title>
<indexterm type="parameter">
<primary>server()</primary>
<secondary>elasticsearch2</secondary>
</indexterm>
<indexterm type="parameter">
<primary>elasticsearch2</primary>
<secondary>server</secondary>
</indexterm>
<informaltable colsep="0" frame="topbot" rowsep="0">
<tgroup cols="2">
<colspec colnum="1" colwidth="40pt"></colspec>
<tbody>
<row>
<entry>Type:</entry>
<entry>list of hostnames</entry>
</row>
<row>
<entry>Default:</entry>
<entry>127.0.0.1</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> Specifies the hostname or IP address of the Elasticsearch server. When specifying an IP address, IPv4 (for example, <span class="Code" oldrole="userinput">192.168.0.1</span>) or IPv6 (for example, <span class="Code" oldrole="userinput">[::1]</span>) can be used as well. When specifying multiple addresses, use space to separate the addresses, for example, <span class="Code" oldrole="userinput">server("127.0.0.1 remote-server-hostname1 remote-server-hostname2")</span></p>
<p oldrole="para">This option is used only in transport mode: <span class="Code" oldrole="userinput">client-mode("transport")</span></p>
<MadCap:snippetBlock src="../../shared/chunk/para-elasticsearch-loadbalancing.htm"></MadCap:snippetBlock>
<p oldrole="para">For example:</p>
<pre class="Code" oldrole="synopsis">destination d_elasticsearch {
  elasticsearch2(
    client-lib-dir("/usr/share/elasticsearch/lib/")
    index("syslog-${YEAR}.${MONTH}.${DAY}")
    type("syslog")
    time-zone("UTC")
    client-mode("http")
    server("node01 node02")
    port(9200)
  );
};</pre>
</simplesect>
<simplesect xml:id="elasticsearch2-option-elasticsearch2-skip-cluster-health-check">
<title>skip-cluster-health-check()</title>
<indexterm type="parameter">
<primary>skip-cluster-health-check()</primary>
<secondary>elasticsearch2</secondary>
</indexterm>
<indexterm type="parameter">
<primary>elasticsearch2</primary>
<secondary>skip-cluster-health-check</secondary>
</indexterm>
<informaltable colsep="0" frame="topbot" rowsep="0">
<tgroup cols="2">
<colspec colnum="1" colwidth="40pt"></colspec>
<tbody>
<row>
<entry>Type:</entry>
<entry>yes|no</entry>
</row>
<row>
<entry>Default:</entry>
<entry>no</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> By default, when connecting to an Elasticsearch cluster, <entity>abbrev</entity> checks the state of the cluster. If the primary shards of the cluster are not active, <entity>abbrev</entity> will not send messages, but wait for them to become active. To disable this health check and send the messages to Elasticsearch anyway, use the <span class="Code" oldrole="userinput">skip-cluster-health-check(yes)</span> option in your configuration.</p>
</simplesect>
<simplesect xml:id="elasticsearch2-option-elasticsearch2-template">
<title>template()</title>
<indexterm type="parameter">
<primary>template()</primary>
<secondary>elasticsearch2</secondary>
</indexterm>
<indexterm type="parameter">
<primary>elasticsearch2</primary>
<secondary>template</secondary>
</indexterm>
<informaltable colsep="0" frame="topbot" rowsep="0">
<tgroup cols="2">
<colspec colnum="1" colwidth="40pt"></colspec>
<tbody>
<row>
<entry>Type:</entry>
<entry>template or template function</entry>
</row>
<row>
<entry>Default:</entry>
<entry>$(format-json --scope rfc5424 --exclude DATE --key ISODATE @timestamp=${ISODATE})</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> The message as sent to the Elasticsearch server. Typically, you will want to use the command-line notation of the <span class="Code" oldrole="userinput">format-json</span> template function.</p>
<p oldrole="para">To add a <span class="Code" oldrole="userinput">@timestamp</span> field to the message, for example, to use with Kibana, include the <span class="Code" oldrole="userinput">@timestamp=${ISODATE}</span> expression in the template. For example: <span class="Code" oldrole="userinput">template($(format-json --scope rfc5424 --exclude DATE --key ISODATE @timestamp=${ISODATE}))</span></p>
<p oldrole="para">For details on formatting messages in JSON format, see <xref linkend="template-function-format-json"></xref>.</p>
</simplesect>
<simplesect>
<MadCap:snippetBlock src="../../shared/chunk/option-destination-throttle.htm"></MadCap:snippetBlock>
</simplesect>
<simplesect>
<MadCap:snippetBlock src="../../shared/chunk/option-destination-timezone.htm"></MadCap:snippetBlock>
<MadCap:snippetBlock src="../../shared/chunk/option-destination-elasticsearch-timezone.htm"></MadCap:snippetBlock>
</simplesect>
<simplesect>
<MadCap:snippetBlock src="../../shared/chunk/option-destination-ts-format.htm"></MadCap:snippetBlock>
</simplesect>
<simplesect xml:id="elasticsearch2-option-elasticsearch2-type">
<title>type()</title>
<indexterm type="parameter">
<primary>type()</primary>
<secondary>elasticsearch2</secondary>
</indexterm>
<indexterm type="parameter">
<primary>elasticsearch2</primary>
<secondary>type</secondary>
</indexterm>
<informaltable colsep="0" frame="topbot" rowsep="0">
<tgroup cols="2">
<colspec colnum="1" colwidth="40pt"></colspec>
<tbody>
<row>
<entry>Type:</entry>
<entry>string</entry>
</row>
<row>
<entry>Default:</entry>
<entry>N/A</entry>
</row>
</tbody>
</tgroup>
</informaltable>
<p oldrole="para"><i oldrole="emphasis" role="bold">Description:</i> The type of the index. For example, <span class="Code" oldrole="userinput">type("test")</span>.</p>
</simplesect>
<MadCap:snippetBlock src="../../shared/chunk/topic-elasticsearch2-practical-examples.htm"></MadCap:snippetBlock>
</body></html>
